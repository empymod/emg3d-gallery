
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>8. Ensure computation domain is big enough &#8212; emg3d-gallery 1.1.0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="9. Transient CSEM" href="timedomain.html" />
    <link rel="prev" title="7. Command-line interface" href="cli.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/emg3d-logo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../references.html">
  References
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://emg3d.emsig.xyz">Documentation<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://emsig.xyz">emsig<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/emsig/emg3d" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Tutorials
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="minimum_example.html">
     1. Minimum working example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mapping.html">
     2. Model property mapping
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="simulation.html">
     3. Simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gradient.html">
     4. Gradient of the misfit function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="total_vs_ps_field.html">
     5. Total vs primary/secondary field
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tests.html">
     6. Parameter tests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cli.html">
     7. Command-line interface
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     8. Ensure computation domain is big enough
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="timedomain.html">
     9. Transient CSEM
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../comparisons/index.html">
   Comparisons
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/1D_VTI_empymod.html">
     1. empymod: 1D VTI resistivity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/2D_triaxial_MARE2DEM.html">
     2. MARE2DEM: 2D with tri-axial anisotropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/3D_triaxial_SimPEG.html">
     3. SimPEG: 3D with tri-axial anisotropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/as_vs_fd_gradient.html">
     4. Adjoint-state vs. FD gradient
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/1D_VTI_empymod_Laplace.html">
     5. empymod: 1D VTI Laplace-domain
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/magnetic_field.html">
     6. Magnetic field due to an el. source
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/magnetic_source_el_loop.html">
     7. Magnetic source using an electric loop
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/magnetic_source_duality.html">
     8. Magnetic source using duality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/magnetic_permeability.html">
     9. Magnetic permeability
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../models/index.html">
   Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../models/GemPy-I.html">
     GemPy-I:
     <em>
      Simple Fault Model
     </em>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../models/GemPy-II.html">
     GemPy-II:
     <em>
      Perth Basin
     </em>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../models/SEG-EAGE_3D_salt_model.html">
     SEG-EAGE 3D Salt Model
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-survey-and-analytical-solution">
   Model, Survey, and Analytical Solution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-modelling">
   3D Modelling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#st-grid-only-considering-air-resistivity-for-z">
   1st grid, only considering air resistivity for +z
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nd-grid-considering-air-resistivity-for-x-y-and-z">
   2nd grid, considering air resistivity for +/- x, +/- y, and +z
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-receiver-responses">
   Plot receiver responses
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-entire-fields-to-analyze-and-compare">
   Plot entire fields to analyze and compare
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#st-grid">
     1st grid
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nd-grid">
     2nd grid
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gallery-tutorials-check-calc-domain-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="ensure-computation-domain-is-big-enough">
<span id="sphx-glr-gallery-tutorials-check-calc-domain-py"></span><h1>8. Ensure computation domain is big enough<a class="headerlink" href="#ensure-computation-domain-is-big-enough" title="Permalink to this headline">¶</a></h1>
<p>Ensure the boundary in <span class="math notranslate nohighlight">\(\pm x\)</span>, <span class="math notranslate nohighlight">\(\pm y\)</span>, and <span class="math notranslate nohighlight">\(+ z\)</span> is big
enough for <span class="math notranslate nohighlight">\(\rho_\text{air}\)</span>.</p>
<p>The air is very resistive, and EM waves propagate at the speed of light as a
wave, not diffusive any longer. The whole concept of skin depth does therefore
not apply to the air layer. The only attenuation is caused by geometrical
spreading. In order to not have any effects from the boundary one has to choose
the air layer appropriately.</p>
<p>The important bit is that the resistivity of air has to be taken into account
also for the horizontal directions, not only for positive <span class="math notranslate nohighlight">\(z\)</span> (upwards
into the sky). This is an example to test boundaries on a simple marine model
(air, water, subsurface) and compare them to the 1D result.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">emg3d</span>
<span class="kn">import</span> <span class="nn">empymod</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LogNorm</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="model-survey-and-analytical-solution">
<h2>Model, Survey, and Analytical Solution<a class="headerlink" href="#model-survey-and-analytical-solution" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">water_depth</span> <span class="o">=</span> <span class="mi">500</span>                        <span class="c1"># 500 m water depth</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">7000</span><span class="p">,</span> <span class="mi">501</span><span class="p">)</span>   <span class="c1"># Offsets</span>
<span class="n">src_coo</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">water_depth</span><span class="o">+</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Src at origin, 50 m above seafloor</span>
<span class="n">rec_coo</span> <span class="o">=</span> <span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">*</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">water_depth</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Receivers on the seafloor</span>
<span class="n">depth</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">water_depth</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>                <span class="c1"># Simple model</span>
<span class="n">resistivity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">]</span>              <span class="c1"># Simple model</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="mf">0.1</span>                          <span class="c1"># Frequency</span>

<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.electrodes.TxElectricDipole.html#emg3d.electrodes.TxElectricDipole" title="emg3d.electrodes.TxElectricDipole" class="sphx-glr-backref-module-emg3d-electrodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.electrodes.TxElectricDipole.html#emg3d.electrodes.TxElectricDipole" title="emg3d.electrodes.TxElectricDipole" class="sphx-glr-backref-module-emg3d-electrodes sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">TxElectricDipole</span></a><span class="p">(</span><span class="n">src_coo</span><span class="p">)</span>

<span class="c1"># Compute analytical solution</span>
<a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span></a> <span class="o">=</span> <span class="n">empymod</span><span class="o">.</span><span class="n">bipole</span><span class="p">(</span><span class="n">src_coo</span><span class="p">,</span> <span class="n">rec_coo</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">resistivity</span><span class="p">,</span> <span class="n">frequency</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>:: empymod END; runtime = 0:00:27.044056 :: 1 kernel call(s)
</pre></div>
</div>
</div>
<div class="section" id="d-modelling">
<h2>3D Modelling<a class="headerlink" href="#d-modelling" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameter we keep the same for both grids</span>
<span class="n">grid_inp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;frequency&#39;</span><span class="p">:</span> <span class="n">frequency</span><span class="p">,</span>
    <span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">src_coo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">water_depth</span><span class="o">-</span><span class="mi">100</span><span class="p">],</span>
    <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="p">([</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">500</span><span class="p">],</span>
               <span class="p">[</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">src_coo</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
               <span class="p">[</span><span class="o">-</span><span class="mi">600</span><span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
    <span class="s1">&#39;seasurface&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;min_width_limits&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">&#39;stretching&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">],</span>
    <span class="s1">&#39;lambda_from_center&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;verb&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="st-grid-only-considering-air-resistivity-for-z">
<h2>1st grid, only considering air resistivity for +z<a class="headerlink" href="#st-grid-only-considering-air-resistivity-for-z" title="Permalink to this headline">¶</a></h2>
<p>Here we are in the water, so the signal is attenuated before it enters the
air. So we don’t use the resistivity of air to compute the required
boundary, but 100 Ohm.m instead. (100 is the result of a quick parameter test
with <span class="math notranslate nohighlight">\(\rho=1e4, 1e3, 1e2, 1e1\)</span>, and the result was that after 100 there
is not much improvement any longer.)</p>
<p>Also note that the function <a class="reference external" href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.construct_mesh.html#emg3d.meshes.construct_mesh" title="(in emg3d v1.1.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">emg3d.meshes.construct_mesh()</span></code></a> internally
uses six times the skin depth for the boundary. For <span class="math notranslate nohighlight">\(\rho\)</span> = 100 Ohm.m
and <span class="math notranslate nohighlight">\(f\)</span> = 0.1 Hz, the skin depth <span class="math notranslate nohighlight">\(\delta\)</span> is roughly 16 km, which
therefore results in a boundary of roughly 96 km.</p>
<p>See the documentation of <code class="xref py py-func docutils literal notranslate"><span class="pre">emg3d.meshes.get_hx_h0()</span></code> for more information
on how the grid is created.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid_1</span></a> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">construct_mesh</span><span class="p">(</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">[</span><span class="n">resistivity</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">resistivity</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resistivity</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">100</span><span class="p">],</span>
    <span class="o">**</span><span class="n">grid_inp</span><span class="p">,</span>
<span class="p">)</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid_1</span></a>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>         == GRIDDING IN X ==
Skin depth     [m] : 872 / 1592 / 1592  [corr. to `properties`]
Survey dom. DS [m] : -500 - 7500
Comp. dom. DC  [m] : -10250 - 13750
Final extent   [m] : -10405 - 14205
Cell widths    [m] : 100 / 100 / 904  [min(DS) / max(DS) / max(DC)]
Number of cells    : 128 (80 / 48 / 0)  [Total (DS/DC/remain)]
Max stretching     : 1.000 (1.000) / 1.088  [DS (seasurface) / DC]

         == GRIDDING IN Y ==
Skin depth     [m] : 872 / 1592 / 1592  [corr. to `properties`]
Survey dom. DS [m] : 0 - 0
Comp. dom. DC  [m] : -10000 - 10000
Final extent   [m] : -10226 - 10226
Cell widths    [m] : 100 / 100 / 1907  [min(DS) / max(DS) / max(DC)]
Number of cells    : 32 (2 / 30 / 0)  [Total (DS/DC/remain)]
Max stretching     : 1.000 (1.000) / 1.217  [DS (seasurface) / DC]

         == GRIDDING IN Z ==
Skin depth     [m] : 872 / 1592 / 15915  [corr. to `properties`]
Survey dom. DS [m] : -600 - 100
Comp. dom. DC  [m] : -10600 - 99400
Final extent   [m] : -12620 - 102179
Cell widths    [m] : 100 / 100 / 19514  [min(DS) / max(DS) / max(DC)]
Number of cells    : 48 (8 / 40 / 0)  [Total (DS/DC/remain)]
Max stretching     : 1.000 (1.000) / 1.235  [DS (seasurface) / DC]
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr>
    <td style='font-weight: bold; font-size: 1.2em; text-align: center;' colspan='3'>TensorMesh</td>
    <td style='font-size: 1.2em; text-align: center;'colspan='4'>196,608 cells</td>
  </tr>
  <tr>
    <th></th>
    <th></th>
    <th colspan='2' style='padding: 5px 20px 5px 20px;'>MESH EXTENT</th>
    <th colspan='2' style='padding: 5px 20px 5px 20px;'>CELL WIDTH</th>
    <th style='padding: 5px 20px 5px 20px;'>FACTOR</th>
  </tr>
  <tr>
    <th style='padding: 5px 20px 5px 20px;'>dir</th>
    <th style='padding: 5px 20px 5px 20px;'>nC</th>
    <th style='padding: 5px 20px 5px 20px;'>min</th>
    <th style='padding: 5px 20px 5px 20px;'>max</th>
    <th style='padding: 5px 20px 5px 20px;'>min</th>
    <th style='padding: 5px 20px 5px 20px;'>max</th>
    <th style='padding: 5px 20px 5px 20px;'>max</th>
  </tr>
  <tr>
    <td style='padding: 5px 20px 5px 20px;'>x</td>
    <td style='padding: 5px 20px 5px 20px;'>128</td>
    <td style='padding: 5px 20px 5px 20px;'>-10,404.94</td>
    <td style='padding: 5px 20px 5px 20px;'>14,204.82</td>
    <td style='padding: 5px 20px 5px 20px;'>100.00</td>
    <td style='padding: 5px 20px 5px 20px;'>904.35</td>
    <td style='padding: 5px 20px 5px 20px;'>1.09</td>
  </tr>
  <tr>
    <td style='padding: 5px 20px 5px 20px;'>y</td>
    <td style='padding: 5px 20px 5px 20px;'>32</td>
    <td style='padding: 5px 20px 5px 20px;'>-10,225.81</td>
    <td style='padding: 5px 20px 5px 20px;'>10,225.81</td>
    <td style='padding: 5px 20px 5px 20px;'>100.00</td>
    <td style='padding: 5px 20px 5px 20px;'>1,906.68</td>
    <td style='padding: 5px 20px 5px 20px;'>1.22</td>
  </tr>
  <tr>
    <td style='padding: 5px 20px 5px 20px;'>z</td>
    <td style='padding: 5px 20px 5px 20px;'>48</td>
    <td style='padding: 5px 20px 5px 20px;'>-12,620.23</td>
    <td style='padding: 5px 20px 5px 20px;'>102,179.01</td>
    <td style='padding: 5px 20px 5px 20px;'>100.00</td>
    <td style='padding: 5px 20px 5px 20px;'>19,513.80</td>
    <td style='padding: 5px 20px 5px 20px;'>1.23</td>
  </tr>
</table>

</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create corresponding model</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_1</span></a> <span class="o">=</span> <span class="n">resistivity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.n_cells" title="discretize.TensorMesh.n_cells" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid_1</span><span class="o">.</span><span class="n">n_cells</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_1</span></a><span class="p">[</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.cell_centers" title="discretize.TensorMesh.cell_centers" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid_1</span><span class="o">.</span><span class="n">cell_centers</span></a><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">water_depth</span><span class="p">]</span> <span class="o">=</span> <span class="n">resistivity</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_1</span></a><span class="p">[</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.cell_centers" title="discretize.TensorMesh.cell_centers" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid_1</span><span class="o">.</span><span class="n">cell_centers</span></a><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">resistivity</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model_1</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Model</span></a><span class="p">(</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid_1</span></a><span class="p">,</span> <span class="n">property_x</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_1</span></a><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="s1">&#39;Resistivity&#39;</span><span class="p">)</span>

<span class="c1"># QC</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.plot_3d_slicer" title="discretize.TensorMesh.plot_3d_slicer" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">grid_1</span><span class="o">.</span><span class="n">plot_3d_slicer</span></a><span class="p">(</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><span class="n">model_1</span><span class="o">.</span><span class="n">property_x</span></a><span class="p">),</span> <span class="n">zlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">clim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="c1"># Solve the system</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">efield_1</span></a> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">solve_source</span><span class="p">(</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model_1</span></a><span class="p">,</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.electrodes.TxElectricDipole.html#emg3d.electrodes.TxElectricDipole" title="emg3d.electrodes.TxElectricDipole" class="sphx-glr-backref-module-emg3d-electrodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source</span></a><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<img alt="check calc domain" class="sphx-glr-single-img" src="../../_images/sphx_glr_check_calc_domain_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>:: emg3d START :: 18:02:39 :: v1.1.0

   MG-cycle       : &#39;F&#39;                 sslsolver : &#39;bicgstab&#39;
   semicoarsening : True [1 2 3]        tol       : 1e-06
   linerelaxation : True [4 5 6]        maxit     : 50 (3)
   nu_{i,1,c,2}   : 0, 2, 1, 2          verb      : 3
   Original grid  : 128 x  32 x  48     =&gt; 196,608 cells
   Coarsest grid  :   2 x   2 x   3     =&gt; 12 cells
   Coarsest level :   6 ;   4 ;   4

:: emg3d :: 1.2e-02; 0(1); 0:00:05
:: emg3d :: 1.4e-03; 0(2); 0:00:09
:: emg3d :: 1.8e-04; 0(3); 0:00:14
:: emg3d :: 6.6e-05; 0(4); 0:00:19
:: emg3d :: 7.9e-06; 0(5); 0:00:23
:: emg3d :: 1.2e-06; 0(6); 0:00:28
:: emg3d :: 7.8e-07; 1(6); 0:00:28

   &gt; CONVERGED
   &gt; Solver steps     : 1
   &gt; MG prec. steps   : 6
   &gt; Final rel. error : 7.844e-07

:: emg3d END   :: 18:03:07 :: runtime = 0:00:28
</pre></div>
</div>
</div>
<div class="section" id="nd-grid-considering-air-resistivity-for-x-y-and-z">
<h2>2nd grid, considering air resistivity for +/- x, +/- y, and +z<a class="headerlink" href="#nd-grid-considering-air-resistivity-for-x-y-and-z" title="Permalink to this headline">¶</a></h2>
<p>See comments below the heading of the 1st grid regarding boundary.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid_2</span></a> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">construct_mesh</span><span class="p">(</span>
    <span class="n">properties</span><span class="o">=</span><span class="p">[</span><span class="n">resistivity</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">resistivity</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">100</span><span class="p">],</span>
    <span class="o">**</span><span class="n">grid_inp</span><span class="p">,</span>
<span class="p">)</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid_2</span></a>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>         == GRIDDING IN X ==
Skin depth     [m] : 872 / 15915 / 15915  [corr. to `properties`]
Survey dom. DS [m] : -500 - 7500
Comp. dom. DC  [m] : -100000 - 100000
Final extent   [m] : -101682 - 108682
Cell widths    [m] : 100 / 100 / 20173  [min(DS) / max(DS) / max(DC)]
Number of cells    : 128 (80 / 48 / 0)  [Total (DS/DC/remain)]
Max stretching     : 1.000 (1.000) / 1.247  [DS (seasurface) / DC]

         == GRIDDING IN Y ==
Skin depth     [m] : 872 / 15915 / 15915  [corr. to `properties`]
Survey dom. DS [m] : 0 - 0
Comp. dom. DC  [m] : -100000 - 100000
Final extent   [m] : -102877 - 102877
Cell widths    [m] : 100 / 100 / 15539  [min(DS) / max(DS) / max(DC)]
Number of cells    : 64 (2 / 62 / 0)  [Total (DS/DC/remain)]
Max stretching     : 1.000 (1.000) / 1.177  [DS (seasurface) / DC]

         == GRIDDING IN Z ==
Skin depth     [m] : 872 / 1592 / 15915  [corr. to `properties`]
Survey dom. DS [m] : -600 - 100
Comp. dom. DC  [m] : -10600 - 99400
Final extent   [m] : -12620 - 102179
Cell widths    [m] : 100 / 100 / 19514  [min(DS) / max(DS) / max(DC)]
Number of cells    : 48 (8 / 40 / 0)  [Total (DS/DC/remain)]
Max stretching     : 1.000 (1.000) / 1.235  [DS (seasurface) / DC]
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr>
    <td style='font-weight: bold; font-size: 1.2em; text-align: center;' colspan='3'>TensorMesh</td>
    <td style='font-size: 1.2em; text-align: center;'colspan='4'>393,216 cells</td>
  </tr>
  <tr>
    <th></th>
    <th></th>
    <th colspan='2' style='padding: 5px 20px 5px 20px;'>MESH EXTENT</th>
    <th colspan='2' style='padding: 5px 20px 5px 20px;'>CELL WIDTH</th>
    <th style='padding: 5px 20px 5px 20px;'>FACTOR</th>
  </tr>
  <tr>
    <th style='padding: 5px 20px 5px 20px;'>dir</th>
    <th style='padding: 5px 20px 5px 20px;'>nC</th>
    <th style='padding: 5px 20px 5px 20px;'>min</th>
    <th style='padding: 5px 20px 5px 20px;'>max</th>
    <th style='padding: 5px 20px 5px 20px;'>min</th>
    <th style='padding: 5px 20px 5px 20px;'>max</th>
    <th style='padding: 5px 20px 5px 20px;'>max</th>
  </tr>
  <tr>
    <td style='padding: 5px 20px 5px 20px;'>x</td>
    <td style='padding: 5px 20px 5px 20px;'>128</td>
    <td style='padding: 5px 20px 5px 20px;'>-101,682.39</td>
    <td style='padding: 5px 20px 5px 20px;'>108,682.39</td>
    <td style='padding: 5px 20px 5px 20px;'>100.00</td>
    <td style='padding: 5px 20px 5px 20px;'>20,172.62</td>
    <td style='padding: 5px 20px 5px 20px;'>1.25</td>
  </tr>
  <tr>
    <td style='padding: 5px 20px 5px 20px;'>y</td>
    <td style='padding: 5px 20px 5px 20px;'>64</td>
    <td style='padding: 5px 20px 5px 20px;'>-102,877.15</td>
    <td style='padding: 5px 20px 5px 20px;'>102,877.15</td>
    <td style='padding: 5px 20px 5px 20px;'>100.00</td>
    <td style='padding: 5px 20px 5px 20px;'>15,538.63</td>
    <td style='padding: 5px 20px 5px 20px;'>1.18</td>
  </tr>
  <tr>
    <td style='padding: 5px 20px 5px 20px;'>z</td>
    <td style='padding: 5px 20px 5px 20px;'>48</td>
    <td style='padding: 5px 20px 5px 20px;'>-12,620.23</td>
    <td style='padding: 5px 20px 5px 20px;'>102,179.01</td>
    <td style='padding: 5px 20px 5px 20px;'>100.00</td>
    <td style='padding: 5px 20px 5px 20px;'>19,513.80</td>
    <td style='padding: 5px 20px 5px 20px;'>1.23</td>
  </tr>
</table>

</div>
<br />
<br /><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create corresponding model</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_2</span></a> <span class="o">=</span> <span class="n">resistivity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.n_cells" title="discretize.TensorMesh.n_cells" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid_2</span><span class="o">.</span><span class="n">n_cells</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_2</span></a><span class="p">[</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.cell_centers" title="discretize.TensorMesh.cell_centers" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid_2</span><span class="o">.</span><span class="n">cell_centers</span></a><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">water_depth</span><span class="p">]</span> <span class="o">=</span> <span class="n">resistivity</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_2</span></a><span class="p">[</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.cell_centers" title="discretize.TensorMesh.cell_centers" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid_2</span><span class="o">.</span><span class="n">cell_centers</span></a><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">resistivity</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model_2</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Model</span></a><span class="p">(</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid_2</span></a><span class="p">,</span> <span class="n">property_x</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">res_2</span></a><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="s1">&#39;Resistivity&#39;</span><span class="p">)</span>

<span class="c1"># QC</span>
<span class="c1"># grid_2.plot_3d_slicer(</span>
<span class="c1">#         np.log10(model_2.property_x), zlim=(-2000, 100), clim=[-1, 2])</span>

<span class="c1"># Define source and solve the system</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field" title="emg3d.fields.Field" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">efield_2</span></a> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">solve_source</span><span class="p">(</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model_2</span></a><span class="p">,</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.electrodes.TxElectricDipole.html#emg3d.electrodes.TxElectricDipole" title="emg3d.electrodes.TxElectricDipole" class="sphx-glr-backref-module-emg3d-electrodes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source</span></a><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>:: emg3d START :: 18:03:08 :: v1.1.0

   MG-cycle       : &#39;F&#39;                 sslsolver : &#39;bicgstab&#39;
   semicoarsening : True [1 2 3]        tol       : 1e-06
   linerelaxation : True [4 5 6]        maxit     : 50 (3)
   nu_{i,1,c,2}   : 0, 2, 1, 2          verb      : 3
   Original grid  : 128 x  64 x  48     =&gt; 393,216 cells
   Coarsest grid  :   2 x   2 x   3     =&gt; 12 cells
   Coarsest level :   6 ;   5 ;   4

:: emg3d :: 1.0e-02; 0(1); 0:00:11
:: emg3d :: 1.9e-03; 0(2); 0:00:21
:: emg3d :: 5.0e-04; 0(3); 0:00:30
:: emg3d :: 6.0e-05; 0(4); 0:00:41
:: emg3d :: 1.0e-05; 0(5); 0:00:50
:: emg3d :: 3.2e-06; 0(6); 0:01:00
:: emg3d :: 2.5e-06; 1(6); 0:01:00
:: emg3d :: 2.2e-07; 1(7); 0:01:10
:: emg3d :: 2.3e-07; 2(7); 0:01:10

   &gt; CONVERGED
   &gt; Solver steps     : 2
   &gt; MG prec. steps   : 7
   &gt; Final rel. error : 2.292e-07

:: emg3d END   :: 18:04:18 :: runtime = 0:01:10
</pre></div>
</div>
</div>
<div class="section" id="plot-receiver-responses">
<h2>Plot receiver responses<a class="headerlink" href="#plot-receiver-responses" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interpolate fields at receiver positions</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_1</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.get_receiver" title="emg3d.fields.Field.get_receiver" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-method"><span class="n">efield_1</span><span class="o">.</span><span class="n">get_receiver</span></a><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">rec_coo</span><span class="p">))</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_2</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.get_receiver" title="emg3d.fields.Field.get_receiver" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-method"><span class="n">efield_2</span><span class="o">.</span><span class="n">get_receiver</span></a><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">rec_coo</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

<span class="c1"># Real, log-lin</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">321</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(a) lin-lin Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">real</span></a><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_1</span><span class="o">.</span><span class="n">real</span></a><span class="p">,</span> <span class="s1">&#39;C0--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;grid 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_2</span><span class="o">.</span><span class="n">real</span></a><span class="p">,</span> <span class="s1">&#39;C1:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;grid 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (V/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Real, log-symlog</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">323</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(c) lin-symlog Real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">real</span></a><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_1</span><span class="o">.</span><span class="n">real</span></a><span class="p">,</span> <span class="s1">&#39;C0--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_2</span><span class="o">.</span><span class="n">real</span></a><span class="p">,</span> <span class="s1">&#39;C1:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$E_x$ (V/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthresh</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">)</span>

<span class="c1"># Real, error</span>
<span class="n">ax5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">325</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(e) clipped 0.01-10&#39;</span><span class="p">)</span>

<span class="c1"># Compute the error</span>
<a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_real_1</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">real</span></a><span class="o">-</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_1</span><span class="o">.</span><span class="n">real</span></a><span class="p">)</span><span class="o">/</span><a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">real</span></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_real_2</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">real</span></a><span class="o">-</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_2</span><span class="o">.</span><span class="n">real</span></a><span class="p">)</span><span class="o">/</span><a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">real</span></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Rel. error %&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_real_1</span></a><span class="p">,</span> <span class="s1">&#39;C0--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_real_2</span></a><span class="p">,</span> <span class="s1">&#39;C1:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Offset (km)&#39;</span><span class="p">)</span>

<span class="c1"># Imaginary, log-lin</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">322</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(b) lin-lin Imag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">imag</span></a><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_1</span><span class="o">.</span><span class="n">imag</span></a><span class="p">,</span> <span class="s1">&#39;C0--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_2</span><span class="o">.</span><span class="n">imag</span></a><span class="p">,</span> <span class="s1">&#39;C1:&#39;</span><span class="p">)</span>

<span class="c1"># Imaginary, log-symlog</span>
<span class="n">ax4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">324</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(d) lin-symlog Imag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">imag</span></a><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_1</span><span class="o">.</span><span class="n">imag</span></a><span class="p">,</span> <span class="s1">&#39;C0--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_2</span><span class="o">.</span><span class="n">imag</span></a><span class="p">,</span> <span class="s1">&#39;C1:&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthresh</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">)</span>

<span class="c1"># Imaginary, error</span>
<span class="n">ax6</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">326</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;(f) clipped 0.01-10&#39;</span><span class="p">)</span>

<span class="c1"># Compute error</span>
<a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_imag_1</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">imag</span></a><span class="o">-</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_1</span><span class="o">.</span><span class="n">imag</span></a><span class="p">)</span><span class="o">/</span><a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">imag</span></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_imag_2</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.clip.html#numpy.clip" title="numpy.clip" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">clip</span></a><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">((</span><a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">imag</span></a><span class="o">-</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.EMArray.html#emg3d.utils.EMArray" title="emg3d.utils.EMArray" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">emg_2</span><span class="o">.</span><span class="n">imag</span></a><span class="p">)</span><span class="o">/</span><a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epm</span><span class="o">.</span><span class="n">imag</span></a><span class="p">),</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_imag_1</span></a><span class="p">,</span> <span class="s1">&#39;C0--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">offsets</span></a><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span> <a href="https://empymod.emsig.xyz/en/stable/api/empymod.utils.EMArray.html#empymod.utils.EMArray" title="empymod.utils.EMArray" class="sphx-glr-backref-module-empymod-utils sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">err_imag_2</span></a><span class="p">,</span> <span class="s1">&#39;C1:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;.4&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.008</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Offset (km)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="(a) lin-lin Real, (c) lin-symlog Real, (e) clipped 0.01-10, (b) lin-lin Imag, (d) lin-symlog Imag, (f) clipped 0.01-10" class="sphx-glr-single-img" src="../../_images/sphx_glr_check_calc_domain_002.png" />
</div>
<div class="section" id="plot-entire-fields-to-analyze-and-compare">
<h2>Plot entire fields to analyze and compare<a class="headerlink" href="#plot-entire-fields-to-analyze-and-compare" title="Permalink to this headline">¶</a></h2>
<div class="section" id="st-grid">
<h3>1st grid<a class="headerlink" href="#st-grid" title="Permalink to this headline">¶</a></h3>
<p>Upper plot shows the entire grid. One can see that the airwave attenuates to
amplitudes in the order of 1e-17 at the boundary, absolutely good enough.
However, the amplitudes in the horizontal directions are very high even at
the boundaries <span class="math notranslate nohighlight">\(\pm x\)</span> and <span class="math notranslate nohighlight">\(\pm y\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.plot_3d_slicer" title="discretize.TensorMesh.plot_3d_slicer" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">grid_1</span><span class="o">.</span><span class="n">plot_3d_slicer</span></a><span class="p">(</span>
    <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><span class="n">efield_1</span><span class="o">.</span><span class="n">fx</span><span class="o">.</span><span class="n">ravel</span></a><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">),</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;abs&#39;</span><span class="p">,</span> <span class="n">v_type</span><span class="o">=</span><span class="s1">&#39;Ex&#39;</span><span class="p">,</span>
    <span class="n">xslice</span><span class="o">=</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yslice</span><span class="o">=</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zslice</span><span class="o">=</span><span class="n">rec_coo</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;norm&#39;</span><span class="p">:</span> <span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1e-17</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">)})</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.plot_3d_slicer" title="discretize.TensorMesh.plot_3d_slicer" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">grid_1</span><span class="o">.</span><span class="n">plot_3d_slicer</span></a><span class="p">(</span>
    <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><span class="n">efield_1</span><span class="o">.</span><span class="n">fx</span><span class="o">.</span><span class="n">ravel</span></a><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">),</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;abs&#39;</span><span class="p">,</span> <span class="n">v_type</span><span class="o">=</span><span class="s1">&#39;Ex&#39;</span><span class="p">,</span>
    <span class="n">zlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="n">xslice</span><span class="o">=</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yslice</span><span class="o">=</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zslice</span><span class="o">=</span><span class="n">rec_coo</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;norm&#39;</span><span class="p">:</span> <span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1e-17</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">)})</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="check calc domain" class="sphx-glr-multi-img" src="../../_images/sphx_glr_check_calc_domain_003.png" />
</li>
<li><img alt="check calc domain" class="sphx-glr-multi-img" src="../../_images/sphx_glr_check_calc_domain_004.png" />
</li>
</ul>
</div>
<div class="section" id="nd-grid">
<h3>2nd grid<a class="headerlink" href="#nd-grid" title="Permalink to this headline">¶</a></h3>
<p>Again, upper plot shows the entire grid. One can see that the field
attenuated sufficiently in all directions. Lower plot shows the same cut-out
as the lower plot for the first grid, our zone of interest.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.plot_3d_slicer" title="discretize.TensorMesh.plot_3d_slicer" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">grid_2</span><span class="o">.</span><span class="n">plot_3d_slicer</span></a><span class="p">(</span>
    <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><span class="n">efield_2</span><span class="o">.</span><span class="n">fx</span><span class="o">.</span><span class="n">ravel</span></a><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">),</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;abs&#39;</span><span class="p">,</span> <span class="n">v_type</span><span class="o">=</span><span class="s1">&#39;Ex&#39;</span><span class="p">,</span>
    <span class="n">xslice</span><span class="o">=</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yslice</span><span class="o">=</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zslice</span><span class="o">=</span><span class="n">rec_coo</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;norm&#39;</span><span class="p">:</span> <span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1e-17</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">)})</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.plot_3d_slicer" title="discretize.TensorMesh.plot_3d_slicer" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">grid_2</span><span class="o">.</span><span class="n">plot_3d_slicer</span></a><span class="p">(</span>
    <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.fields.Field.html#emg3d.fields.Field.fx" title="emg3d.fields.Field.fx" class="sphx-glr-backref-module-emg3d-fields sphx-glr-backref-type-py-attribute"><span class="n">efield_2</span><span class="o">.</span><span class="n">fx</span><span class="o">.</span><span class="n">ravel</span></a><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">),</span> <span class="n">view</span><span class="o">=</span><span class="s1">&#39;abs&#39;</span><span class="p">,</span> <span class="n">v_type</span><span class="o">=</span><span class="s1">&#39;Ex&#39;</span><span class="p">,</span>
    <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nodes_x" title="discretize.TensorMesh.nodes_x" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid_1</span><span class="o">.</span><span class="n">nodes_x</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nodes_x" title="discretize.TensorMesh.nodes_x" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid_1</span><span class="o">.</span><span class="n">nodes_x</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>  <span class="c1"># Same square as grid_1</span>
    <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nodes_y" title="discretize.TensorMesh.nodes_y" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid_1</span><span class="o">.</span><span class="n">nodes_y</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nodes_y" title="discretize.TensorMesh.nodes_y" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid_1</span><span class="o">.</span><span class="n">nodes_y</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>  <span class="c1"># Same square as grid_1</span>
    <span class="n">zlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="n">xslice</span><span class="o">=</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yslice</span><span class="o">=</span><span class="n">src_coo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">zslice</span><span class="o">=</span><span class="n">rec_coo</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;norm&#39;</span><span class="p">:</span> <span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1e-17</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">)})</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img alt="check calc domain" class="sphx-glr-multi-img" src="../../_images/sphx_glr_check_calc_domain_005.png" />
</li>
<li><img alt="check calc domain" class="sphx-glr-multi-img" src="../../_images/sphx_glr_check_calc_domain_006.png" />
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.Report.html#emg3d.utils.Report" title="emg3d.utils.Report" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Report</span></a><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table style='border: 3px solid #ddd;'>
  <tr>
     <td style='text-align: center; font-weight: bold; font-size: 1.2em; border: 2px solid #fff;' colspan='6'>Sat Jul 17 18:04:24 2021 CEST</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>OS</td>
    <td style='text-align: left; border: 2px solid #fff;'>Linux</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>CPU(s)</td>
    <td style='text-align: left; border: 2px solid #fff;'>4</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Machine</td>
    <td style='text-align: left; border: 2px solid #fff;'>x86_64</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Architecture</td>
    <td style='text-align: left; border: 2px solid #fff;'>64bit</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>RAM</td>
    <td style='text-align: left; border: 2px solid #fff;'>15.5 GiB</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Environment</td>
    <td style='text-align: left; border: 2px solid #fff;'>Python</td>
  </tr>
  <tr>
     <td style='text-align: center; border: 2px solid #fff;' colspan='6'>Python 3.9.4 | packaged by conda-forge | (default, May 10 2021, 22:13:33)
[GCC 9.3.0]</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>numpy</td>
    <td style='text-align: left; border: 2px solid #fff;'>1.21.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>scipy</td>
    <td style='text-align: left; border: 2px solid #fff;'>1.7.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>numba</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.53.1</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>emg3d</td>
    <td style='text-align: left; border: 2px solid #fff;'>1.1.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>empymod</td>
    <td style='text-align: left; border: 2px solid #fff;'>2.1.2</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>xarray</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.18.2</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>discretize</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.7.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>h5py</td>
    <td style='text-align: left; border: 2px solid #fff;'>3.3.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>matplotlib</td>
    <td style='text-align: left; border: 2px solid #fff;'>3.4.2</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>tqdm</td>
    <td style='text-align: left; border: 2px solid #fff;'>4.61.2</td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
  </tr>
  <tr>
     <td style='text-align: center; background-color: #ddd;border: 2px solid #fff;' colspan='6'>Intel(R) oneAPI Math Kernel Library Version 2021.2-Product Build 20210312 for Intel(R) 64 architecture applications</td>
  </tr>
</table>
</div>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 2 minutes  14.294 seconds)</p>
<p><strong>Estimated memory usage:</strong>  293 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-tutorials-check-calc-domain-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/16123177805a25e8233530f71c01c959/check_calc_domain.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">check_calc_domain.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/f012c3fcb7e3dc8001c83601c94420c3/check_calc_domain.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">check_calc_domain.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="cli.html" title="previous page">7. Command-line interface</a>
    <a class='right-next' id="next-link" href="timedomain.html" title="next page">9. Transient CSEM</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2018-2021, The emsig community.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>