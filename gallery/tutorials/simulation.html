
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. Simulation &#8212; emg3d-gallery 1.1.0 documentation</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4. Gradient of the misfit function" href="gradient.html" />
    <link rel="prev" title="2. Model property mapping" href="mapping.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/emg3d-logo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Gallery
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../references.html">
  References
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://emg3d.emsig.xyz">Documentation<i class="fas fa-external-link-alt"></i></a>
    </li>
    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://emsig.xyz">emsig<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/emsig/emg3d" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   Tutorials
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="minimum_example.html">
     1. Minimum working example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="mapping.html">
     2. Model property mapping
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3. Simulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="gradient.html">
     4. Gradient of the misfit function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="total_vs_ps_field.html">
     5. Total vs primary/secondary field
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="parameter_tests.html">
     6. Parameter tests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cli.html">
     7. Command-line interface
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="check_calc_domain.html">
     8. Ensure computation domain is big enough
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="timedomain.html">
     9. Transient CSEM
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../comparisons/index.html">
   Comparisons
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/1D_VTI_empymod.html">
     1. empymod: 1D VTI resistivity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/2D_triaxial_MARE2DEM.html">
     2. MARE2DEM: 2D with tri-axial anisotropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/3D_triaxial_SimPEG.html">
     3. SimPEG: 3D with tri-axial anisotropy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/as_vs_fd_gradient.html">
     4. Adjoint-state vs. FD gradient
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/1D_VTI_empymod_Laplace.html">
     5. empymod: 1D VTI Laplace-domain
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/magnetic_field.html">
     6. Magnetic field due to an el. source
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/magnetic_source_el_loop.html">
     7. Magnetic source using an electric loop
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/magnetic_source_duality.html">
     8. Magnetic source using duality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../comparisons/magnetic_permeability.html">
     9. Magnetic permeability
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../models/index.html">
   Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../models/GemPy-I.html">
     GemPy-I:
     <em>
      Simple Fault Model
     </em>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../models/GemPy-II.html">
     GemPy-II:
     <em>
      Perth Basin
     </em>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../models/SEG-EAGE_3D_salt_model.html">
     SEG-EAGE 3D Salt Model
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fetch-the-model">
   Fetch the model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-the-survey">
   Define the survey
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extract-seafloor-to-simulate-source-and-receiver-depths">
     Extract seafloor to simulate source and receiver depths
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#source-and-receiver-positions">
     Source and receiver positions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-survey">
     Create Survey
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#qc-model-and-survey">
   QC model and survey
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-a-simulation-to-compute-observed-data">
   Create a Simulation (to compute ‘observed’ data)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#automatic-gridding">
     Automatic gridding
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compute-the-data">
     Compute the data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#qc-data">
   QC Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-to-store-surveys-and-simulations-to-disk">
   How to store surveys and simulations to disk
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gallery-tutorials-simulation-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="simulation">
<span id="sphx-glr-gallery-tutorials-simulation-py"></span><h1>3. Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline">¶</a></h1>
<p>The easiest way to model CSEM data for a survey is to make use of the Survey
and Simulation classes, <a class="reference external" href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey" title="(in emg3d v1.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">emg3d.surveys.Survey</span></code></a> and
<a class="reference external" href="https://emg3d.emsig.xyz/en/stable/api/emg3d.simulations.Simulation.html#emg3d.simulations.Simulation" title="(in emg3d v1.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">emg3d.simulations.Simulation</span></code></a>, respectively, together with the
automatic gridding functionality.</p>
<p>For this example we use the resistivity model created in the example
<a class="reference internal" href="../models/GemPy-II.html#sphx-glr-gallery-models-gempy-ii-py"><span class="std std-ref">GemPy-II: Perth Basin</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pooch</span>
<span class="kn">import</span> <span class="nn">emg3d</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LogNorm</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <a href="https://docs.scipy.org/doc/scipy/reference/reference/generated/scipy.interpolate.RectBivariateSpline.html#scipy.interpolate.RectBivariateSpline" title="scipy.interpolate.RectBivariateSpline" class="sphx-glr-backref-module-scipy-interpolate sphx-glr-backref-type-py-class"><span class="n">RectBivariateSpline</span></a>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;bmh&#39;</span><span class="p">)</span>


<span class="c1"># Adjust this path to a folder of your choice.</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;download&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="fetch-the-model">
<h2>Fetch the model<a class="headerlink" href="#fetch-the-model" title="Permalink to this headline">¶</a></h2>
<p>Retrieve and load the pre-computed resistivity model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;GemPy-II.h5&quot;</span>
<span class="n">pooch</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
    <span class="s1">&#39;https://raw.github.com/emsig/data/2021-05-21/emg3d/models/&#39;</span><span class="o">+</span><span class="n">fname</span><span class="p">,</span>
    <span class="s1">&#39;ea8c23be80522d3ca8f36742c93758370df89188816f50cb4e1b2a6a3012d659&#39;</span><span class="p">,</span>
    <span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span>
    <span class="n">path</span><span class="o">=</span><span class="n">data_path</span><span class="p">,</span>
<span class="p">)</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a> <span class="o">=</span> <span class="n">emg3d</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data_path</span> <span class="o">+</span> <span class="n">fname</span><span class="p">)[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Data loaded from «/home/dtr/Codes/emsig/emg3d-gallery/examples/download/GemPy-II.h5»
[emg3d v1.0.0rc3.dev5+g0cd9e09 (format 1.0) on 2021-05-21T18:40:16.721968].
</pre></div>
</div>
<p>Let’s check the model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Model: resistivity; isotropic; 100 x 100 x 102 (1,020,000)
</pre></div>
</div>
<p>So it is an isotropic model defined in terms of resistivities. Let’s check
the grid</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span><span class="o">.</span><span class="n">grid</span></a>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.TensorMesh.html#emg3d.meshes.TensorMesh" title="emg3d.meshes.TensorMesh" class="sphx-glr-backref-module-emg3d-meshes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">grid</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table>
  <tr>
    <td style='font-weight: bold; font-size: 1.2em; text-align: center;' colspan='3'>TensorMesh</td>
    <td style='font-size: 1.2em; text-align: center;'colspan='4'>1,020,000 cells</td>
  </tr>
  <tr>
    <th></th>
    <th></th>
    <th colspan='2' style='padding: 5px 20px 5px 20px;'>MESH EXTENT</th>
    <th colspan='2' style='padding: 5px 20px 5px 20px;'>CELL WIDTH</th>
    <th style='padding: 5px 20px 5px 20px;'>FACTOR</th>
  </tr>
  <tr>
    <th style='padding: 5px 20px 5px 20px;'>dir</th>
    <th style='padding: 5px 20px 5px 20px;'>nC</th>
    <th style='padding: 5px 20px 5px 20px;'>min</th>
    <th style='padding: 5px 20px 5px 20px;'>max</th>
    <th style='padding: 5px 20px 5px 20px;'>min</th>
    <th style='padding: 5px 20px 5px 20px;'>max</th>
    <th style='padding: 5px 20px 5px 20px;'>max</th>
  </tr>
  <tr>
    <td style='padding: 5px 20px 5px 20px;'>x</td>
    <td style='padding: 5px 20px 5px 20px;'>100</td>
    <td style='padding: 5px 20px 5px 20px;'>0.00</td>
    <td style='padding: 5px 20px 5px 20px;'>20,000.00</td>
    <td style='padding: 5px 20px 5px 20px;'>200.00</td>
    <td style='padding: 5px 20px 5px 20px;'>200.00</td>
    <td style='padding: 5px 20px 5px 20px;'>1.00</td>
  </tr>
  <tr>
    <td style='padding: 5px 20px 5px 20px;'>y</td>
    <td style='padding: 5px 20px 5px 20px;'>100</td>
    <td style='padding: 5px 20px 5px 20px;'>0.00</td>
    <td style='padding: 5px 20px 5px 20px;'>20,000.00</td>
    <td style='padding: 5px 20px 5px 20px;'>200.00</td>
    <td style='padding: 5px 20px 5px 20px;'>200.00</td>
    <td style='padding: 5px 20px 5px 20px;'>1.00</td>
  </tr>
  <tr>
    <td style='padding: 5px 20px 5px 20px;'>z</td>
    <td style='padding: 5px 20px 5px 20px;'>102</td>
    <td style='padding: 5px 20px 5px 20px;'>-7,000.00</td>
    <td style='padding: 5px 20px 5px 20px;'>500.00</td>
    <td style='padding: 5px 20px 5px 20px;'>50.00</td>
    <td style='padding: 5px 20px 5px 20px;'>2,000.00</td>
    <td style='padding: 5px 20px 5px 20px;'>40.00</td>
  </tr>
</table>

</div>
<br />
<br /></div>
<div class="section" id="define-the-survey">
<h2>Define the survey<a class="headerlink" href="#define-the-survey" title="Permalink to this headline">¶</a></h2>
<p>If you have actual field data then this info would normally come from a data
file or similar. Here we create our own dummy survey, and later will create
synthetic data for it.</p>
<p>A <strong>Survey</strong> instance contains all survey-related information, hence source
and receiver positions and measured data. See the relevant documentation for
more details: <a class="reference external" href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey" title="(in emg3d v1.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">emg3d.surveys.Survey</span></code></a>.</p>
<div class="section" id="extract-seafloor-to-simulate-source-and-receiver-depths">
<h3>Extract seafloor to simulate source and receiver depths<a class="headerlink" href="#extract-seafloor-to-simulate-source-and-receiver-depths" title="Permalink to this headline">¶</a></h3>
<p>To create a realistic survey we create a small routine that finds the
seafloor, so we can place receivers on the seafloor and sources 50 m above
it. We use the fact that the seawater has resistivity of 0.3 Ohm.m in the
model, and is the lowest value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seafloor</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">((</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.shape_cells" title="discretize.TensorMesh.shape_cells" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid</span><span class="o">.</span><span class="n">shape_cells</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.shape_cells" title="discretize.TensorMesh.shape_cells" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid</span><span class="o">.</span><span class="n">shape_cells</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.shape_cells" title="discretize.TensorMesh.shape_cells" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid</span><span class="o">.</span><span class="n">shape_cells</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.shape_cells" title="discretize.TensorMesh.shape_cells" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid</span><span class="o">.</span><span class="n">shape_cells</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="c1"># We take the seafloor to be the first cell which resistivity</span>
        <span class="c1"># is below 0.33</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seafloor</span></a><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.nodes_z" title="discretize.TensorMesh.nodes_z" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid</span><span class="o">.</span><span class="n">nodes_z</span></a><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span>
                <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><span class="n">model</span><span class="o">.</span><span class="n">property_x</span></a><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">ii</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&lt;</span> <span class="mf">0.33</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Create a 2D interpolation function from it</span>
<a href="https://docs.scipy.org/doc/scipy/reference/reference/generated/scipy.interpolate.RectBivariateSpline.html#scipy.interpolate.RectBivariateSpline" title="scipy.interpolate.RectBivariateSpline" class="sphx-glr-backref-module-scipy-interpolate sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bathymetry</span></a> <span class="o">=</span> <a href="https://docs.scipy.org/doc/scipy/reference/reference/generated/scipy.interpolate.RectBivariateSpline.html#scipy.interpolate.RectBivariateSpline" title="scipy.interpolate.RectBivariateSpline" class="sphx-glr-backref-module-scipy-interpolate sphx-glr-backref-type-py-class"><span class="n">RectBivariateSpline</span></a><span class="p">(</span>
        <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.cell_centers_x" title="discretize.TensorMesh.cell_centers_x" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid</span><span class="o">.</span><span class="n">cell_centers_x</span></a><span class="p">,</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.cell_centers_y" title="discretize.TensorMesh.cell_centers_y" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-attribute"><span class="n">grid</span><span class="o">.</span><span class="n">cell_centers_y</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">seafloor</span></a><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="source-and-receiver-positions">
<h3>Source and receiver positions<a class="headerlink" href="#source-and-receiver-positions" title="Permalink to this headline">¶</a></h3>
<p>Sources and receivers can be defined in a few different ways. One way is by
providing coordinates, where two coordinate formats are accepted:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(x0,</span> <span class="pre">x1,</span> <span class="pre">y0,</span> <span class="pre">y1,</span> <span class="pre">z0,</span> <span class="pre">z1)</span></code>: finite length dipole,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y,</span> <span class="pre">z,</span> <span class="pre">azimuth,</span> <span class="pre">elevation)</span></code>: point dipole,</p></li>
</ul>
<p>where the angles (azimuth and elevation) are in degrees. For the coordinate
system see <a class="reference external" href="https://empymod.emsig.xyz/en/stable/examples/coordinate_system.html">coordinate_system</a>.</p>
<p>A survey can contain electric and magnetic receivers, arbitrarily rotated.
However, the <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> is currently limited to electric receivers.</p>
<p>Note that the survey just knows about the sources, receivers, frequencies,
and observed data - it does not know anything of an underlying model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Angles for horizontal, x-directed Ex point dipoles</span>
<span class="n">elevation</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">azimuth</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="c1"># Acquisition source frequencies (Hz)</span>
<span class="n">frequencies</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>

<span class="c1"># Source coordinates</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_x</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="mi">5000</span>
<span class="n">src_y</span> <span class="o">=</span> <span class="mi">7500</span>
<span class="c1"># Source depths: 50 m above seafloor</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_z</span></a> <span class="o">=</span> <a href="https://docs.scipy.org/doc/scipy/reference/reference/generated/scipy.interpolate.RectBivariateSpline.html#scipy.interpolate.RectBivariateSpline" title="scipy.interpolate.RectBivariateSpline" class="sphx-glr-backref-module-scipy-interpolate sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bathymetry</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_x</span></a><span class="p">,</span> <span class="n">src_y</span><span class="p">)</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">+</span><span class="mi">50</span>
<span class="n">src</span> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.txrx_coordinates_to_dict.html#emg3d.surveys.txrx_coordinates_to_dict" title="emg3d.surveys.txrx_coordinates_to_dict" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-function"><span class="n">emg3d</span><span class="o">.</span><span class="n">surveys</span><span class="o">.</span><span class="n">txrx_coordinates_to_dict</span></a><span class="p">(</span>
        <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.electrodes.TxElectricDipole.html#emg3d.electrodes.TxElectricDipole" title="emg3d.electrodes.TxElectricDipole" class="sphx-glr-backref-module-emg3d-electrodes sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">TxElectricDipole</span></a><span class="p">,</span>
        <span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_x</span></a><span class="p">,</span> <span class="n">src_y</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_z</span></a><span class="p">,</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">elevation</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Receiver positions</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_x</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_y</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="o">+</span><span class="mi">6500</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">RX</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">RY</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_x</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_y</span></a><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">RZ</span></a> <span class="o">=</span> <a href="https://docs.scipy.org/doc/scipy/reference/reference/generated/scipy.interpolate.RectBivariateSpline.html#scipy.interpolate.RectBivariateSpline" title="scipy.interpolate.RectBivariateSpline" class="sphx-glr-backref-module-scipy-interpolate sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bathymetry</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_x</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_y</span></a><span class="p">)</span>
<span class="n">rec</span> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.txrx_coordinates_to_dict.html#emg3d.surveys.txrx_coordinates_to_dict" title="emg3d.surveys.txrx_coordinates_to_dict" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-function"><span class="n">emg3d</span><span class="o">.</span><span class="n">surveys</span><span class="o">.</span><span class="n">txrx_coordinates_to_dict</span></a><span class="p">(</span>
        <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.electrodes.RxElectricPoint.html#emg3d.electrodes.RxElectricPoint" title="emg3d.electrodes.RxElectricPoint" class="sphx-glr-backref-module-emg3d-electrodes sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">RxElectricPoint</span></a><span class="p">,</span>
        <span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">RX</span></a><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">RY</span></a><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">RZ</span></a><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">azimuth</span><span class="p">,</span> <span class="n">elevation</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="create-survey">
<h3>Create Survey<a class="headerlink" href="#create-survey" title="Permalink to this headline">¶</a></h3>
<p>If you have observed data you can provide them, here we will create synthetic
data later on. What you have to define is the expected noise floor and
relative error, which is used to compute the misfit later on. Alternatively
you can provide directly the standard deviation; see
<a class="reference external" href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey" title="(in emg3d v1.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">emg3d.surveys.Survey</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey" title="emg3d.surveys.Survey" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey" title="emg3d.surveys.Survey" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">surveys</span><span class="o">.</span><span class="n">Survey</span></a><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;GemPy-II Survey A&#39;</span><span class="p">,</span>  <span class="c1"># Name of the survey</span>
    <span class="n">sources</span><span class="o">=</span><span class="n">src</span><span class="p">,</span>               <span class="c1"># Source coordinates</span>
    <span class="n">receivers</span><span class="o">=</span><span class="n">rec</span><span class="p">,</span>             <span class="c1"># Receiver coordinates</span>
    <span class="n">frequencies</span><span class="o">=</span><span class="n">frequencies</span><span class="p">,</span>   <span class="c1"># Two frequencies</span>
    <span class="c1"># data=data,               # If you have observed data</span>
    <span class="n">noise_floor</span><span class="o">=</span><span class="mf">1e-15</span><span class="p">,</span>
    <span class="n">relative_error</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Let&#39;s have a look at the survey:</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey" title="emg3d.surveys.Survey" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<h3>Survey «GemPy-II Survey A»</h3><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:   (freq: 2, rec: 45, src: 3)
Coordinates:
  * src       (src) &lt;U6 &#x27;TxED-1&#x27; &#x27;TxED-2&#x27; &#x27;TxED-3&#x27;
  * rec       (rec) &lt;U7 &#x27;RxEP-01&#x27; &#x27;RxEP-02&#x27; &#x27;RxEP-03&#x27; ... &#x27;RxEP-44&#x27; &#x27;RxEP-45&#x27;
  * freq      (freq) &lt;U3 &#x27;f-1&#x27; &#x27;f-2&#x27;
Data variables:
    observed  (src, rec, freq) complex128 (nan+nanj) (nan+nanj) ... (nan+nanj)
Attributes:
    noise_floor:     1e-15
    relative_error:  0.05</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-4774a9a7-43da-4a35-ad2f-ac0cc2d8d6e9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4774a9a7-43da-4a35-ad2f-ac0cc2d8d6e9' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>freq</span>: 2</li><li><span class='xr-has-index'>rec</span>: 45</li><li><span class='xr-has-index'>src</span>: 3</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d4ac689f-ad52-4198-823e-17dd915a1e02' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d4ac689f-ad52-4198-823e-17dd915a1e02' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>src</span></div><div class='xr-var-dims'>(src)</div><div class='xr-var-dtype'>&lt;U6</div><div class='xr-var-preview xr-preview'>&#x27;TxED-1&#x27; &#x27;TxED-2&#x27; &#x27;TxED-3&#x27;</div><input id='attrs-bbcd1b5d-b6a1-463e-8d8e-a86c24120cbf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bbcd1b5d-b6a1-463e-8d8e-a86c24120cbf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b1058055-c934-4578-87d8-fb541e36d513' class='xr-var-data-in' type='checkbox'><label for='data-b1058055-c934-4578-87d8-fb541e36d513' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Sources :</span></dt><dd>TxED-1: TxElectricDipole: 1.0 A;
    center={5,000.0; 7,500.0; -2,305.8} m; θ=0.0°, φ=0.0°; l=1.0 m;
TxED-2: TxElectricDipole: 1.0 A;
    center={10,000.0; 7,500.0; -2,020.7} m; θ=0.0°, φ=0.0°; l=1.0 m;
TxED-3: TxElectricDipole: 1.0 A;
    center={15,000.0; 7,500.0; -2,170.0} m; θ=0.0°, φ=0.0°; l=1.0 m.</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;TxED-1&#x27;, &#x27;TxED-2&#x27;, &#x27;TxED-3&#x27;], dtype=&#x27;&lt;U6&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>rec</span></div><div class='xr-var-dims'>(rec)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;RxEP-01&#x27; &#x27;RxEP-02&#x27; ... &#x27;RxEP-45&#x27;</div><input id='attrs-d861993d-f455-40f8-bc37-d5cce7bde120' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d861993d-f455-40f8-bc37-d5cce7bde120' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d51d9078-075b-47bf-b0de-13f463e47d9d' class='xr-var-data-in' type='checkbox'><label for='data-d51d9078-075b-47bf-b0de-13f463e47d9d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Receivers :</span></dt><dd>RxEP-01: RxElectricPoint: absolute;
    x=3,000.0 m, y=6,500.0 m, z=-2,200.9 m, θ=0.0°, φ=0.0°;
RxEP-02: RxElectricPoint: absolute;
    x=3,000.0 m, y=7,500.0 m, z=-2,220.0 m, θ=0.0°, φ=0.0°;
RxEP-03: RxElectricPoint: absolute;
    x=3,000.0 m, y=8,500.0 m, z=-2,271.7 m, θ=0.0°, φ=0.0°;
RxEP-04: RxElectricPoint: absolute;
    x=4,000.0 m, y=6,500.0 m, z=-2,185.2 m, θ=0.0°, φ=0.0°;
RxEP-05: RxElectricPoint: absolute;
    x=4,000.0 m, y=7,500.0 m, z=-2,226.6 m, θ=0.0°, φ=0.0°;
RxEP-06: RxElectricPoint: absolute;
    x=4,000.0 m, y=8,500.0 m, z=-2,207.7 m, θ=0.0°, φ=0.0°;
RxEP-07: RxElectricPoint: absolute;
    x=5,000.0 m, y=6,500.0 m, z=-2,243.9 m, θ=0.0°, φ=0.0°;
RxEP-08: RxElectricPoint: absolute;
    x=5,000.0 m, y=7,500.0 m, z=-2,355.8 m, θ=0.0°, φ=0.0°;
RxEP-09: RxElectricPoint: absolute;
    x=5,000.0 m, y=8,500.0 m, z=-2,226.8 m, θ=0.0°, φ=0.0°;
RxEP-10: RxElectricPoint: absolute;
    x=6,000.0 m, y=6,500.0 m, z=-2,181.3 m, θ=0.0°, φ=0.0°;
RxEP-11: RxElectricPoint: absolute;
    x=6,000.0 m, y=7,500.0 m, z=-2,305.7 m, θ=0.0°, φ=0.0°;
RxEP-12: RxElectricPoint: absolute;
    x=6,000.0 m, y=8,500.0 m, z=-2,272.6 m, θ=0.0°, φ=0.0°;
RxEP-13: RxElectricPoint: absolute;
    x=7,000.0 m, y=6,500.0 m, z=-2,051.4 m, θ=0.0°, φ=0.0°;
RxEP-14: RxElectricPoint: absolute;
    x=7,000.0 m, y=7,500.0 m, z=-2,108.8 m, θ=0.0°, φ=0.0°;
RxEP-15: RxElectricPoint: absolute;
    x=7,000.0 m, y=8,500.0 m, z=-2,069.3 m, θ=0.0°, φ=0.0°;
RxEP-16: RxElectricPoint: absolute;
    x=8,000.0 m, y=6,500.0 m, z=-2,050.1 m, θ=0.0°, φ=0.0°;
RxEP-17: RxElectricPoint: absolute;
    x=8,000.0 m, y=7,500.0 m, z=-2,100.5 m, θ=0.0°, φ=0.0°;
RxEP-18: RxElectricPoint: absolute;
    x=8,000.0 m, y=8,500.0 m, z=-2,025.0 m, θ=0.0°, φ=0.0°;
RxEP-19: RxElectricPoint: absolute;
    x=9,000.0 m, y=6,500.0 m, z=-2,070.1 m, θ=0.0°, φ=0.0°;
RxEP-20: RxElectricPoint: absolute;
    x=9,000.0 m, y=7,500.0 m, z=-2,098.6 m, θ=0.0°, φ=0.0°;
RxEP-21: RxElectricPoint: absolute;
    x=9,000.0 m, y=8,500.0 m, z=-2,000.0 m, θ=0.0°, φ=0.0°;
RxEP-22: RxElectricPoint: absolute;
    x=10,000.0 m, y=6,500.0 m, z=-1,997.0 m, θ=0.0°, φ=0.0°;
RxEP-23: RxElectricPoint: absolute;
    x=10,000.0 m, y=7,500.0 m, z=-2,070.7 m, θ=0.0°, φ=0.0°;
RxEP-24: RxElectricPoint: absolute;
    x=10,000.0 m, y=8,500.0 m, z=-2,016.3 m, θ=0.0°, φ=0.0°;
RxEP-25: RxElectricPoint: absolute;
    x=11,000.0 m, y=6,500.0 m, z=-2,272.7 m, θ=0.0°, φ=0.0°;
RxEP-26: RxElectricPoint: absolute;
    x=11,000.0 m, y=7,500.0 m, z=-2,300.7 m, θ=0.0°, φ=0.0°;
RxEP-27: RxElectricPoint: absolute;
    x=11,000.0 m, y=8,500.0 m, z=-2,221.5 m, θ=0.0°, φ=0.0°;
RxEP-28: RxElectricPoint: absolute;
    x=12,000.0 m, y=6,500.0 m, z=-2,401.2 m, θ=0.0°, φ=0.0°;
RxEP-29: RxElectricPoint: absolute;
    x=12,000.0 m, y=7,500.0 m, z=-2,352.0 m, θ=0.0°, φ=0.0°;
RxEP-30: RxElectricPoint: absolute;
    x=12,000.0 m, y=8,500.0 m, z=-2,345.6 m, θ=0.0°, φ=0.0°;
RxEP-31: RxElectricPoint: absolute;
    x=13,000.0 m, y=6,500.0 m, z=-2,430.3 m, θ=0.0°, φ=0.0°;
RxEP-32: RxElectricPoint: absolute;
    x=13,000.0 m, y=7,500.0 m, z=-2,301.3 m, θ=0.0°, φ=0.0°;
RxEP-33: RxElectricPoint: absolute;
    x=13,000.0 m, y=8,500.0 m, z=-2,270.9 m, θ=0.0°, φ=0.0°;
RxEP-34: RxElectricPoint: absolute;
    x=14,000.0 m, y=6,500.0 m, z=-2,295.0 m, θ=0.0°, φ=0.0°;
RxEP-35: RxElectricPoint: absolute;
    x=14,000.0 m, y=7,500.0 m, z=-2,299.9 m, θ=0.0°, φ=0.0°;
RxEP-36: RxElectricPoint: absolute;
    x=14,000.0 m, y=8,500.0 m, z=-2,272.3 m, θ=0.0°, φ=0.0°;
RxEP-37: RxElectricPoint: absolute;
    x=15,000.0 m, y=6,500.0 m, z=-2,300.4 m, θ=0.0°, φ=0.0°;
RxEP-38: RxElectricPoint: absolute;
    x=15,000.0 m, y=7,500.0 m, z=-2,220.0 m, θ=0.0°, φ=0.0°;
RxEP-39: RxElectricPoint: absolute;
    x=15,000.0 m, y=8,500.0 m, z=-2,199.6 m, θ=0.0°, φ=0.0°;
RxEP-40: RxElectricPoint: absolute;
    x=16,000.0 m, y=6,500.0 m, z=-2,257.7 m, θ=0.0°, φ=0.0°;
RxEP-41: RxElectricPoint: absolute;
    x=16,000.0 m, y=7,500.0 m, z=-2,204.7 m, θ=0.0°, φ=0.0°;
RxEP-42: RxElectricPoint: absolute;
    x=16,000.0 m, y=8,500.0 m, z=-2,199.7 m, θ=0.0°, φ=0.0°;
RxEP-43: RxElectricPoint: absolute;
    x=17,000.0 m, y=6,500.0 m, z=-2,270.0 m, θ=0.0°, φ=0.0°;
RxEP-44: RxElectricPoint: absolute;
    x=17,000.0 m, y=7,500.0 m, z=-2,273.8 m, θ=0.0°, φ=0.0°;
RxEP-45: RxElectricPoint: absolute;
    x=17,000.0 m, y=8,500.0 m, z=-2,330.1 m, θ=0.0°, φ=0.0°.</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;RxEP-01&#x27;, &#x27;RxEP-02&#x27;, &#x27;RxEP-03&#x27;, &#x27;RxEP-04&#x27;, &#x27;RxEP-05&#x27;, &#x27;RxEP-06&#x27;,
       &#x27;RxEP-07&#x27;, &#x27;RxEP-08&#x27;, &#x27;RxEP-09&#x27;, &#x27;RxEP-10&#x27;, &#x27;RxEP-11&#x27;, &#x27;RxEP-12&#x27;,
       &#x27;RxEP-13&#x27;, &#x27;RxEP-14&#x27;, &#x27;RxEP-15&#x27;, &#x27;RxEP-16&#x27;, &#x27;RxEP-17&#x27;, &#x27;RxEP-18&#x27;,
       &#x27;RxEP-19&#x27;, &#x27;RxEP-20&#x27;, &#x27;RxEP-21&#x27;, &#x27;RxEP-22&#x27;, &#x27;RxEP-23&#x27;, &#x27;RxEP-24&#x27;,
       &#x27;RxEP-25&#x27;, &#x27;RxEP-26&#x27;, &#x27;RxEP-27&#x27;, &#x27;RxEP-28&#x27;, &#x27;RxEP-29&#x27;, &#x27;RxEP-30&#x27;,
       &#x27;RxEP-31&#x27;, &#x27;RxEP-32&#x27;, &#x27;RxEP-33&#x27;, &#x27;RxEP-34&#x27;, &#x27;RxEP-35&#x27;, &#x27;RxEP-36&#x27;,
       &#x27;RxEP-37&#x27;, &#x27;RxEP-38&#x27;, &#x27;RxEP-39&#x27;, &#x27;RxEP-40&#x27;, &#x27;RxEP-41&#x27;, &#x27;RxEP-42&#x27;,
       &#x27;RxEP-43&#x27;, &#x27;RxEP-44&#x27;, &#x27;RxEP-45&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>freq</span></div><div class='xr-var-dims'>(freq)</div><div class='xr-var-dtype'>&lt;U3</div><div class='xr-var-preview xr-preview'>&#x27;f-1&#x27; &#x27;f-2&#x27;</div><input id='attrs-8d280e1d-1123-404b-924a-3dd74494ecf2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8d280e1d-1123-404b-924a-3dd74494ecf2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-feddacb7-f820-4181-a1f6-86849518fbab' class='xr-var-data-in' type='checkbox'><label for='data-feddacb7-f820-4181-a1f6-86849518fbab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Frequencies :</span></dt><dd>f-1: 0.5 Hz;
f-2: 1.0 Hz.</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;f-1&#x27;, &#x27;f-2&#x27;], dtype=&#x27;&lt;U3&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a55b9a49-362f-40b4-8e39-8b2c94549c9d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a55b9a49-362f-40b4-8e39-8b2c94549c9d' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>observed</span></div><div class='xr-var-dims'>(src, rec, freq)</div><div class='xr-var-dtype'>complex128</div><div class='xr-var-preview xr-preview'>(nan+nanj) ... (nan+nanj)</div><input id='attrs-395a9ff5-74a0-4526-9955-50fb5eda7054' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-395a9ff5-74a0-4526-9955-50fb5eda7054' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe4d40ad-7c6b-42f9-a226-9daaae5e787e' class='xr-var-data-in' type='checkbox'><label for='data-fe4d40ad-7c6b-42f9-a226-9daaae5e787e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
...
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj],
        [nan+nanj, nan+nanj]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f3f88682-0ff0-46f4-9899-0cc4aea23751' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f3f88682-0ff0-46f4-9899-0cc4aea23751' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>noise_floor :</span></dt><dd>1e-15</dd><dt><span>relative_error :</span></dt><dd>0.05</dd></dl></div></li></ul></div></div>
</div>
<br />
<br /><p>Our survey has our sources and receivers and initiated a variable
<code class="docutils literal notranslate"><span class="pre">observed</span></code>, with NaN’s. Each source and receiver got a name assigned. If
you prefer other names you would have to define the sources and receivers
through <code class="docutils literal notranslate"><span class="pre">emg3d.surveys.Dipole</span></code>, and provide a list of dipoles to the survey
instead of only a tuple of coordinates.</p>
<p>We can also look at a particular source or receiver, e.g.,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey.sources" title="emg3d.surveys.Survey.sources" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-attribute"><span class="n">survey</span><span class="o">.</span><span class="n">sources</span></a><span class="p">[</span><span class="s1">&#39;TxED-1&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>TxElectricDipole: 1.0 A;
    center={5,000.0; 7,500.0; -2,305.8} m; θ=0.0°, φ=0.0°; l=1.0 m
</pre></div>
</div>
<p>Which shows you all you need to know about a particular dipole: name, type
(electric or magnetic), coordinates of its center, angles, and length.</p>
</div>
</div>
<div class="section" id="qc-model-and-survey">
<h2>QC model and survey<a class="headerlink" href="#qc-model-and-survey" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TensorMesh.html#discretize.TensorMesh.plot_3d_slicer" title="discretize.TensorMesh.plot_3d_slicer" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">grid</span><span class="o">.</span><span class="n">plot_3d_slicer</span></a><span class="p">(</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model.property_x" title="emg3d.models.Model.property_x" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-attribute"><span class="n">model</span><span class="o">.</span><span class="n">property_x</span></a><span class="p">,</span> <span class="n">xslice</span><span class="o">=</span><span class="mi">12000</span><span class="p">,</span> <span class="n">yslice</span><span class="o">=</span><span class="mi">7000</span><span class="p">,</span>
                    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;norm&#39;</span><span class="p">:</span> <span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">)})</span>

<span class="c1"># Plot survey in figure above</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Resistivity model (Ohm.m) and survey layout&#39;</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_children</span><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey.receiver_coordinates" title="emg3d.surveys.Survey.receiver_coordinates" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-method"><span class="n">survey</span><span class="o">.</span><span class="n">receiver_coordinates</span></a><span class="p">()</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_coords</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey.source_coordinates" title="emg3d.surveys.Survey.source_coordinates" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-method"><span class="n">survey</span><span class="o">.</span><span class="n">source_coordinates</span></a><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;bv&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;bv&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;bv&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_coords</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_coords</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r*&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_coords</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_coords</span></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;r*&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_coords</span></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">src_coords</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r*&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Resistivity model (Ohm.m) and survey layout" class="sphx-glr-single-img" src="../../_images/sphx_glr_simulation_001.png" />
</div>
<div class="section" id="create-a-simulation-to-compute-observed-data">
<h2>Create a Simulation (to compute ‘observed’ data)<a class="headerlink" href="#create-a-simulation-to-compute-observed-data" title="Permalink to this headline">¶</a></h2>
<p>The simulation class combines a model with a survey, and can compute
synthetic data for it.</p>
<div class="section" id="automatic-gridding">
<h3>Automatic gridding<a class="headerlink" href="#automatic-gridding" title="Permalink to this headline">¶</a></h3>
<p>We use the automatic gridding feature implemented in the simulation class to
use source- and frequency- dependent grids for the computation.
Consult the following docs for more information:</p>
<ul class="simple">
<li><p><cite>gridding_opts</cite> in <a class="reference external" href="https://emg3d.emsig.xyz/en/stable/api/emg3d.simulations.Simulation.html#emg3d.simulations.Simulation" title="(in emg3d v1.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">emg3d.simulations.Simulation</span></code></a>;</p></li>
<li><p><a class="reference external" href="https://emg3d.emsig.xyz/en/stable/api/emg3d.simulations.estimate_gridding_opts.html#emg3d.simulations.estimate_gridding_opts" title="(in emg3d v1.1.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">emg3d.simulations.estimate_gridding_opts()</span></code></a>; and</p></li>
<li><p><a class="reference external" href="https://emg3d.emsig.xyz/en/stable/api/emg3d.meshes.construct_mesh.html#emg3d.meshes.construct_mesh" title="(in emg3d v1.1.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">emg3d.meshes.construct_mesh()</span></code></a>.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gopts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
    <span class="s1">&#39;min_width_limits&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
    <span class="s1">&#39;stretching&#39;</span><span class="p">:</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]),</span>
    <span class="s1">&#39;domain&#39;</span><span class="p">:</span> <span class="p">(</span>
        <span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">100</span><span class="p">],</span>
        <span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">+</span><span class="mi">100</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mi">5500</span><span class="p">,</span> <span class="o">-</span><span class="mi">2000</span><span class="p">]</span>
    <span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now we can initiate the simulation class and QC it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.simulations.Simulation.html#emg3d.simulations.Simulation" title="emg3d.simulations.Simulation" class="sphx-glr-backref-module-emg3d-simulations sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">simulation</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.simulations.Simulation.html#emg3d.simulations.Simulation" title="emg3d.simulations.Simulation" class="sphx-glr-backref-module-emg3d-simulations sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">simulations</span><span class="o">.</span><span class="n">Simulation</span></a><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;True Model&quot;</span><span class="p">,</span>    <span class="c1"># A name for this simulation</span>
    <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey" title="emg3d.surveys.Survey" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey</span></a><span class="o">=</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey" title="emg3d.surveys.Survey" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey</span></a><span class="p">,</span>        <span class="c1"># Our survey instance</span>
    <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="o">=</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.models.Model.html#emg3d.models.Model" title="emg3d.models.Model" class="sphx-glr-backref-module-emg3d-models sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">model</span></a><span class="p">,</span>          <span class="c1"># The model</span>
    <span class="n">gridding</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span>      <span class="c1"># Frequency- and source-dependent meshes</span>
    <span class="n">max_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>        <span class="c1"># How many parallel jobs</span>
    <span class="c1"># solver_opts,        # Any parameter to pass to emg3d.solve</span>
    <span class="n">gridding_opts</span><span class="o">=</span><span class="n">gopts</span><span class="p">,</span>  <span class="c1"># Gridding options</span>
<span class="p">)</span>

<span class="c1"># Let&#39;s QC our Simulation instance</span>
<a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.simulations.Simulation.html#emg3d.simulations.Simulation" title="emg3d.simulations.Simulation" class="sphx-glr-backref-module-emg3d-simulations sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">simulation</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<h3>Simulation «True Model»</h3><ul>  <li>Survey «GemPy-II Survey A»:    3 sources;    45 receivers;    2 frequencies</li>  <li>Model: resistivity; isotropic; 100 x 100 x 102 (1,020,000)</li>  <li>Gridding: Frequency- and source-dependent grids;     160 x 40 x 48 (307,200) - 192 x 48 x 64 (589,824)</li></ul>
</div>
<br />
<br /></div>
<div class="section" id="compute-the-data">
<h3>Compute the data<a class="headerlink" href="#compute-the-data" title="Permalink to this headline">¶</a></h3>
<p>We pass here the argument <code class="docutils literal notranslate"><span class="pre">observed=True</span></code>; this way, the synthetic data is
stored in our Survey as <code class="docutils literal notranslate"><span class="pre">observed</span></code> data, otherwise it would be stored as
<code class="docutils literal notranslate"><span class="pre">synthetic</span></code>. This is important later for optimization. It also adds
Gaussian noise according to the noise floor and relative error we defined in
the survey. By setting a minimum offset the receivers close to the source are
switched off.</p>
<p>This computes all results in parallel; in this case six models, three sources
times two frequencies. You can change the number of workers at any time by
setting <code class="docutils literal notranslate"><span class="pre">simulation.max_workers</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.simulations.Simulation.html#emg3d.simulations.Simulation.compute" title="emg3d.simulations.Simulation.compute" class="sphx-glr-backref-module-emg3d-simulations sphx-glr-backref-type-py-method"><span class="n">simulation</span><span class="o">.</span><span class="n">compute</span></a><span class="p">(</span><span class="n">observed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">min_offset</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Compute efields:           0/6  [00:00]
Compute efields: #6        1/6  [01:35]
Compute efields: ########3 5/6  [01:42]
Compute efields: ##########6/6  [01:42]
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">Simulation</span></code> has a few convenience functions, e.g.:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">simulation.get_efield('TxED-1',</span> <span class="pre">0.5)</span></code>: Returns the electric field of the
entire domain for source <code class="docutils literal notranslate"><span class="pre">'TxED-1'</span></code> and frequency 0.5 Hz.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simulation.get_hfield</span></code>; <code class="docutils literal notranslate"><span class="pre">simulation.get_sfield</span></code>: Similar functions to
retrieve the magnetic fields and the source fields.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simulation.get_model</span></code>; <code class="docutils literal notranslate"><span class="pre">simulation.get_grid</span></code>: Similar functions to
retrieve the computational grid and the model for a given source and
frequency.</p></li>
</ul>
<p>When we now look at our survey we see that the observed data variable is
filled with the responses at the receiver locations. Note that the
<code class="docutils literal notranslate"><span class="pre">synthetic</span></code> data is the actual computed data, the <code class="docutils literal notranslate"><span class="pre">observed</span></code> data, on the
other hand, has Gaussian noise added and is set to NaN’s for positions too
close to the source.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey" title="emg3d.surveys.Survey" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey</span></a>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<h3>Survey «GemPy-II Survey A»</h3><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (freq: 2, rec: 45, src: 3)
Coordinates:
  * src        (src) &lt;U6 &#x27;TxED-1&#x27; &#x27;TxED-2&#x27; &#x27;TxED-3&#x27;
  * rec        (rec) &lt;U7 &#x27;RxEP-01&#x27; &#x27;RxEP-02&#x27; &#x27;RxEP-03&#x27; ... &#x27;RxEP-44&#x27; &#x27;RxEP-45&#x27;
  * freq       (freq) &lt;U3 &#x27;f-1&#x27; &#x27;f-2&#x27;
Data variables:
    observed   (src, rec, freq) complex128 (-1.9881093039936688e-14-5.1325032...
    synthetic  (src, rec, freq) complex128 (-1.826678497953133e-14-5.42883141...
Attributes:
    noise_floor:     1e-15
    relative_error:  0.05</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a7f29136-148c-44ba-9daf-cb3c730ef716' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a7f29136-148c-44ba-9daf-cb3c730ef716' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>freq</span>: 2</li><li><span class='xr-has-index'>rec</span>: 45</li><li><span class='xr-has-index'>src</span>: 3</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-cf349e95-db8e-4b5a-9a45-48829e0f3a89' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cf349e95-db8e-4b5a-9a45-48829e0f3a89' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>src</span></div><div class='xr-var-dims'>(src)</div><div class='xr-var-dtype'>&lt;U6</div><div class='xr-var-preview xr-preview'>&#x27;TxED-1&#x27; &#x27;TxED-2&#x27; &#x27;TxED-3&#x27;</div><input id='attrs-b0e3ec1d-fb1e-4c7d-b739-752e06c8aeef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b0e3ec1d-fb1e-4c7d-b739-752e06c8aeef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a81552de-4adf-4663-96ec-99e76b18fa69' class='xr-var-data-in' type='checkbox'><label for='data-a81552de-4adf-4663-96ec-99e76b18fa69' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Sources :</span></dt><dd>TxED-1: TxElectricDipole: 1.0 A;
    center={5,000.0; 7,500.0; -2,305.8} m; θ=0.0°, φ=0.0°; l=1.0 m;
TxED-2: TxElectricDipole: 1.0 A;
    center={10,000.0; 7,500.0; -2,020.7} m; θ=0.0°, φ=0.0°; l=1.0 m;
TxED-3: TxElectricDipole: 1.0 A;
    center={15,000.0; 7,500.0; -2,170.0} m; θ=0.0°, φ=0.0°; l=1.0 m.</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;TxED-1&#x27;, &#x27;TxED-2&#x27;, &#x27;TxED-3&#x27;], dtype=&#x27;&lt;U6&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>rec</span></div><div class='xr-var-dims'>(rec)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;RxEP-01&#x27; &#x27;RxEP-02&#x27; ... &#x27;RxEP-45&#x27;</div><input id='attrs-a428b848-2915-4c5e-96ca-57f5401e85e4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a428b848-2915-4c5e-96ca-57f5401e85e4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2072e9b3-b387-4246-88ba-e18727dd66f2' class='xr-var-data-in' type='checkbox'><label for='data-2072e9b3-b387-4246-88ba-e18727dd66f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Receivers :</span></dt><dd>RxEP-01: RxElectricPoint: absolute;
    x=3,000.0 m, y=6,500.0 m, z=-2,200.9 m, θ=0.0°, φ=0.0°;
RxEP-02: RxElectricPoint: absolute;
    x=3,000.0 m, y=7,500.0 m, z=-2,220.0 m, θ=0.0°, φ=0.0°;
RxEP-03: RxElectricPoint: absolute;
    x=3,000.0 m, y=8,500.0 m, z=-2,271.7 m, θ=0.0°, φ=0.0°;
RxEP-04: RxElectricPoint: absolute;
    x=4,000.0 m, y=6,500.0 m, z=-2,185.2 m, θ=0.0°, φ=0.0°;
RxEP-05: RxElectricPoint: absolute;
    x=4,000.0 m, y=7,500.0 m, z=-2,226.6 m, θ=0.0°, φ=0.0°;
RxEP-06: RxElectricPoint: absolute;
    x=4,000.0 m, y=8,500.0 m, z=-2,207.7 m, θ=0.0°, φ=0.0°;
RxEP-07: RxElectricPoint: absolute;
    x=5,000.0 m, y=6,500.0 m, z=-2,243.9 m, θ=0.0°, φ=0.0°;
RxEP-08: RxElectricPoint: absolute;
    x=5,000.0 m, y=7,500.0 m, z=-2,355.8 m, θ=0.0°, φ=0.0°;
RxEP-09: RxElectricPoint: absolute;
    x=5,000.0 m, y=8,500.0 m, z=-2,226.8 m, θ=0.0°, φ=0.0°;
RxEP-10: RxElectricPoint: absolute;
    x=6,000.0 m, y=6,500.0 m, z=-2,181.3 m, θ=0.0°, φ=0.0°;
RxEP-11: RxElectricPoint: absolute;
    x=6,000.0 m, y=7,500.0 m, z=-2,305.7 m, θ=0.0°, φ=0.0°;
RxEP-12: RxElectricPoint: absolute;
    x=6,000.0 m, y=8,500.0 m, z=-2,272.6 m, θ=0.0°, φ=0.0°;
RxEP-13: RxElectricPoint: absolute;
    x=7,000.0 m, y=6,500.0 m, z=-2,051.4 m, θ=0.0°, φ=0.0°;
RxEP-14: RxElectricPoint: absolute;
    x=7,000.0 m, y=7,500.0 m, z=-2,108.8 m, θ=0.0°, φ=0.0°;
RxEP-15: RxElectricPoint: absolute;
    x=7,000.0 m, y=8,500.0 m, z=-2,069.3 m, θ=0.0°, φ=0.0°;
RxEP-16: RxElectricPoint: absolute;
    x=8,000.0 m, y=6,500.0 m, z=-2,050.1 m, θ=0.0°, φ=0.0°;
RxEP-17: RxElectricPoint: absolute;
    x=8,000.0 m, y=7,500.0 m, z=-2,100.5 m, θ=0.0°, φ=0.0°;
RxEP-18: RxElectricPoint: absolute;
    x=8,000.0 m, y=8,500.0 m, z=-2,025.0 m, θ=0.0°, φ=0.0°;
RxEP-19: RxElectricPoint: absolute;
    x=9,000.0 m, y=6,500.0 m, z=-2,070.1 m, θ=0.0°, φ=0.0°;
RxEP-20: RxElectricPoint: absolute;
    x=9,000.0 m, y=7,500.0 m, z=-2,098.6 m, θ=0.0°, φ=0.0°;
RxEP-21: RxElectricPoint: absolute;
    x=9,000.0 m, y=8,500.0 m, z=-2,000.0 m, θ=0.0°, φ=0.0°;
RxEP-22: RxElectricPoint: absolute;
    x=10,000.0 m, y=6,500.0 m, z=-1,997.0 m, θ=0.0°, φ=0.0°;
RxEP-23: RxElectricPoint: absolute;
    x=10,000.0 m, y=7,500.0 m, z=-2,070.7 m, θ=0.0°, φ=0.0°;
RxEP-24: RxElectricPoint: absolute;
    x=10,000.0 m, y=8,500.0 m, z=-2,016.3 m, θ=0.0°, φ=0.0°;
RxEP-25: RxElectricPoint: absolute;
    x=11,000.0 m, y=6,500.0 m, z=-2,272.7 m, θ=0.0°, φ=0.0°;
RxEP-26: RxElectricPoint: absolute;
    x=11,000.0 m, y=7,500.0 m, z=-2,300.7 m, θ=0.0°, φ=0.0°;
RxEP-27: RxElectricPoint: absolute;
    x=11,000.0 m, y=8,500.0 m, z=-2,221.5 m, θ=0.0°, φ=0.0°;
RxEP-28: RxElectricPoint: absolute;
    x=12,000.0 m, y=6,500.0 m, z=-2,401.2 m, θ=0.0°, φ=0.0°;
RxEP-29: RxElectricPoint: absolute;
    x=12,000.0 m, y=7,500.0 m, z=-2,352.0 m, θ=0.0°, φ=0.0°;
RxEP-30: RxElectricPoint: absolute;
    x=12,000.0 m, y=8,500.0 m, z=-2,345.6 m, θ=0.0°, φ=0.0°;
RxEP-31: RxElectricPoint: absolute;
    x=13,000.0 m, y=6,500.0 m, z=-2,430.3 m, θ=0.0°, φ=0.0°;
RxEP-32: RxElectricPoint: absolute;
    x=13,000.0 m, y=7,500.0 m, z=-2,301.3 m, θ=0.0°, φ=0.0°;
RxEP-33: RxElectricPoint: absolute;
    x=13,000.0 m, y=8,500.0 m, z=-2,270.9 m, θ=0.0°, φ=0.0°;
RxEP-34: RxElectricPoint: absolute;
    x=14,000.0 m, y=6,500.0 m, z=-2,295.0 m, θ=0.0°, φ=0.0°;
RxEP-35: RxElectricPoint: absolute;
    x=14,000.0 m, y=7,500.0 m, z=-2,299.9 m, θ=0.0°, φ=0.0°;
RxEP-36: RxElectricPoint: absolute;
    x=14,000.0 m, y=8,500.0 m, z=-2,272.3 m, θ=0.0°, φ=0.0°;
RxEP-37: RxElectricPoint: absolute;
    x=15,000.0 m, y=6,500.0 m, z=-2,300.4 m, θ=0.0°, φ=0.0°;
RxEP-38: RxElectricPoint: absolute;
    x=15,000.0 m, y=7,500.0 m, z=-2,220.0 m, θ=0.0°, φ=0.0°;
RxEP-39: RxElectricPoint: absolute;
    x=15,000.0 m, y=8,500.0 m, z=-2,199.6 m, θ=0.0°, φ=0.0°;
RxEP-40: RxElectricPoint: absolute;
    x=16,000.0 m, y=6,500.0 m, z=-2,257.7 m, θ=0.0°, φ=0.0°;
RxEP-41: RxElectricPoint: absolute;
    x=16,000.0 m, y=7,500.0 m, z=-2,204.7 m, θ=0.0°, φ=0.0°;
RxEP-42: RxElectricPoint: absolute;
    x=16,000.0 m, y=8,500.0 m, z=-2,199.7 m, θ=0.0°, φ=0.0°;
RxEP-43: RxElectricPoint: absolute;
    x=17,000.0 m, y=6,500.0 m, z=-2,270.0 m, θ=0.0°, φ=0.0°;
RxEP-44: RxElectricPoint: absolute;
    x=17,000.0 m, y=7,500.0 m, z=-2,273.8 m, θ=0.0°, φ=0.0°;
RxEP-45: RxElectricPoint: absolute;
    x=17,000.0 m, y=8,500.0 m, z=-2,330.1 m, θ=0.0°, φ=0.0°.</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;RxEP-01&#x27;, &#x27;RxEP-02&#x27;, &#x27;RxEP-03&#x27;, &#x27;RxEP-04&#x27;, &#x27;RxEP-05&#x27;, &#x27;RxEP-06&#x27;,
       &#x27;RxEP-07&#x27;, &#x27;RxEP-08&#x27;, &#x27;RxEP-09&#x27;, &#x27;RxEP-10&#x27;, &#x27;RxEP-11&#x27;, &#x27;RxEP-12&#x27;,
       &#x27;RxEP-13&#x27;, &#x27;RxEP-14&#x27;, &#x27;RxEP-15&#x27;, &#x27;RxEP-16&#x27;, &#x27;RxEP-17&#x27;, &#x27;RxEP-18&#x27;,
       &#x27;RxEP-19&#x27;, &#x27;RxEP-20&#x27;, &#x27;RxEP-21&#x27;, &#x27;RxEP-22&#x27;, &#x27;RxEP-23&#x27;, &#x27;RxEP-24&#x27;,
       &#x27;RxEP-25&#x27;, &#x27;RxEP-26&#x27;, &#x27;RxEP-27&#x27;, &#x27;RxEP-28&#x27;, &#x27;RxEP-29&#x27;, &#x27;RxEP-30&#x27;,
       &#x27;RxEP-31&#x27;, &#x27;RxEP-32&#x27;, &#x27;RxEP-33&#x27;, &#x27;RxEP-34&#x27;, &#x27;RxEP-35&#x27;, &#x27;RxEP-36&#x27;,
       &#x27;RxEP-37&#x27;, &#x27;RxEP-38&#x27;, &#x27;RxEP-39&#x27;, &#x27;RxEP-40&#x27;, &#x27;RxEP-41&#x27;, &#x27;RxEP-42&#x27;,
       &#x27;RxEP-43&#x27;, &#x27;RxEP-44&#x27;, &#x27;RxEP-45&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>freq</span></div><div class='xr-var-dims'>(freq)</div><div class='xr-var-dtype'>&lt;U3</div><div class='xr-var-preview xr-preview'>&#x27;f-1&#x27; &#x27;f-2&#x27;</div><input id='attrs-a5569a2d-238b-44c3-95fa-b44626302eda' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a5569a2d-238b-44c3-95fa-b44626302eda' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4bd1454e-bcd8-472d-89fd-d3ee1adab21a' class='xr-var-data-in' type='checkbox'><label for='data-4bd1454e-bcd8-472d-89fd-d3ee1adab21a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>Frequencies :</span></dt><dd>f-1: 0.5 Hz;
f-2: 1.0 Hz.</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;f-1&#x27;, &#x27;f-2&#x27;], dtype=&#x27;&lt;U3&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7058db4e-429c-4f29-bcad-4d26668cc870' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7058db4e-429c-4f29-bcad-4d26668cc870' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>observed</span></div><div class='xr-var-dims'>(src, rec, freq)</div><div class='xr-var-dtype'>complex128</div><div class='xr-var-preview xr-preview'>(-1.9881093039936688e-14-5.13250...</div><input id='attrs-7bcab0a6-0e00-439a-a7a0-8c310c22564e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7bcab0a6-0e00-439a-a7a0-8c310c22564e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7af9ec80-67ae-448d-b245-4fa439043347' class='xr-var-data-in' type='checkbox'><label for='data-7af9ec80-67ae-448d-b245-4fa439043347' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[-1.98810930e-14-5.13250328e-13j,
         -3.17757697e-13-4.54604234e-14j],
        [-4.10737808e-13-1.51309132e-12j,
         -9.36025418e-13-2.34628226e-13j],
        [-1.36511826e-14-4.14834993e-13j,
         -2.70182850e-13-6.70607868e-14j],
        [-1.05954069e-12+5.20941987e-12j,
          2.42374226e-12+9.86548811e-13j],
        [ 1.96357597e-11-2.48929859e-11j,
          9.04935190e-12-2.29168176e-11j],
        [-6.56716596e-13+3.91273240e-12j,
          2.34218714e-12+9.80984270e-13j],
        [-3.91829097e-11+3.58368148e-11j,
         -4.73052540e-12+3.95916978e-11j],
        [            nan           +nanj,
                     nan           +nanj],
        [-3.43706687e-11+3.38899484e-11j,
         -1.92821736e-12+4.12210746e-11j],
        [-9.61708236e-13+4.33322046e-12j,
          2.11012211e-12+5.89547003e-13j],
...
        [-1.51806027e-12+4.50781901e-12j,
          2.05112626e-12+1.66679662e-12j],
        [-4.27814186e-11+3.58921221e-11j,
         -8.58432868e-12+3.73399327e-11j],
        [            nan           +nanj,
                     nan           +nanj],
        [-3.96595451e-11+3.77382623e-11j,
         -4.57425066e-12+4.05802703e-11j],
        [-4.45565643e-13+5.36088332e-12j,
          2.91486855e-12+1.21891514e-12j],
        [ 2.35843671e-11-2.43294942e-11j,
          1.13328267e-11-2.11715933e-11j],
        [-1.10169546e-12+5.16909619e-12j,
          2.69098699e-12+1.25638243e-12j],
        [ 5.07520263e-14-5.68145230e-13j,
         -3.48341097e-13-1.34384065e-13j],
        [-1.09534964e-13-1.92038153e-12j,
         -9.83455016e-13-7.97030705e-13j],
        [ 1.58909855e-13-5.68016621e-13j,
         -3.62428350e-13-2.51083177e-13j]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>synthetic</span></div><div class='xr-var-dims'>(src, rec, freq)</div><div class='xr-var-dtype'>complex128</div><div class='xr-var-preview xr-preview'>(-1.826678497953133e-14-5.428831...</div><input id='attrs-5613eda4-aa9f-4d48-bdc3-99122e3755a2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5613eda4-aa9f-4d48-bdc3-99122e3755a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e4e40e1-7264-42f3-b1ab-682b1ce15b0b' class='xr-var-data-in' type='checkbox'><label for='data-2e4e40e1-7264-42f3-b1ab-682b1ce15b0b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[-1.82667850e-14-5.42883142e-13j,
         -3.30864873e-13-4.68624680e-14j],
        [-3.39411739e-13-1.54192259e-12j,
         -8.78107662e-13-2.76880604e-13j],
        [-1.55023099e-14-4.21818749e-13j,
         -2.78103128e-13-4.44467021e-14j],
        [-9.48934127e-13+4.91353803e-12j,
          2.59302060e-12+1.17080986e-12j],
        [ 1.97283683e-11-2.61420795e-11j,
          8.18768917e-12-2.11752353e-11j],
        [-9.98759419e-13+3.82124032e-12j,
          2.21867000e-12+1.02226384e-12j],
        [-4.08554404e-11+3.58543591e-11j,
         -6.00598908e-12+4.13111035e-11j],
        [-3.63605320e-08-2.73889654e-09j,
         -3.70450679e-08-5.07111300e-09j],
        [-4.10608112e-11+3.69559194e-11j,
         -5.34122545e-12+4.19044932e-11j],
        [-7.61290259e-13+4.08380667e-12j,
          2.08275197e-12+8.21298180e-13j],
...
        [-1.60212176e-12+4.72853150e-12j,
          2.22345046e-12+1.60668318e-12j],
        [-4.35140896e-11+3.67098347e-11j,
         -8.16618833e-12+4.32514912e-11j],
        [-3.37500504e-08-2.79747758e-09j,
         -3.45337087e-08-5.17024908e-09j],
        [-4.33368594e-11+3.82879654e-11j,
         -6.58591917e-12+4.37034224e-11j],
        [-7.20029872e-13+5.19530656e-12j,
          2.93495111e-12+1.16094520e-12j],
        [ 2.52101120e-11-2.64421723e-11j,
          1.41534516e-11-2.31189962e-11j],
        [-1.12199571e-12+4.71707873e-12j,
          2.65321159e-12+1.27539499e-12j],
        [ 6.43692632e-14-5.76766510e-13j,
         -3.64366052e-13-1.44905171e-13j],
        [-7.00003428e-15-1.93475408e-12j,
         -1.01827583e-12-6.87864445e-13j],
        [ 1.43489102e-13-6.33190446e-13j,
         -3.71980671e-13-2.49818332e-13j]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-50e34295-21bb-493a-a50e-983b952a2c2c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-50e34295-21bb-493a-a50e-983b952a2c2c' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>noise_floor :</span></dt><dd>1e-15</dd><dt><span>relative_error :</span></dt><dd>0.05</dd></dl></div></li></ul></div></div>
</div>
<br />
<br /></div>
</div>
<div class="section" id="qc-data">
<h2>QC Data<a class="headerlink" href="#qc-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Inline receivers for all sources&quot;</span><span class="p">)</span>
<a href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.DataArray" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">obs</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.simulations.Simulation.html#emg3d.simulations.Simulation.data" title="emg3d.simulations.Simulation.data" class="sphx-glr-backref-module-emg3d-simulations sphx-glr-backref-type-py-attribute"><span class="n">simulation</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">observed</span></a><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>
<a href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="xarray.DataArray" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">syn</span></a> <span class="o">=</span> <a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.simulations.Simulation.html#emg3d.simulations.Simulation.data" title="emg3d.simulations.Simulation.data" class="sphx-glr-backref-module-emg3d-simulations sphx-glr-backref-type-py-attribute"><span class="n">simulation</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">synthetic</span></a><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">3</span><span class="p">,</span> <span class="p">:]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">src</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey.sources" title="emg3d.surveys.Survey.sources" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-attribute"><span class="n">survey</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">keys</span></a><span class="p">()):</span>
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">freq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.surveys.Survey.html#emg3d.surveys.Survey.frequencies" title="emg3d.surveys.Survey.frequencies" class="sphx-glr-backref-module-emg3d-surveys sphx-glr-backref-type-py-attribute"><span class="n">survey</span><span class="o">.</span><span class="n">frequencies</span></a><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">::</span><span class="mi">3</span><span class="p">],</span>
                 <span class="nb">abs</span><span class="p">(</span><a href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.loc.html#xarray.DataArray.loc" title="xarray.DataArray.loc" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">syn</span><span class="o">.</span><span class="n">loc</span></a><span class="p">[</span><span class="n">src</span><span class="p">,</span> <span class="p">:,</span> <span class="n">freq</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">real</span><span class="p">),</span>
                 <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">::</span><span class="mi">3</span><span class="p">],</span>
                 <span class="nb">abs</span><span class="p">(</span><a href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.loc.html#xarray.DataArray.loc" title="xarray.DataArray.loc" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">syn</span><span class="o">.</span><span class="n">loc</span></a><span class="p">[</span><span class="n">src</span><span class="p">,</span> <span class="p">:,</span> <span class="n">freq</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">imag</span><span class="p">),</span>
                 <span class="s2">&quot;k-&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">::</span><span class="mi">3</span><span class="p">],</span>
                 <span class="nb">abs</span><span class="p">(</span><a href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.loc.html#xarray.DataArray.loc" title="xarray.DataArray.loc" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">obs</span><span class="o">.</span><span class="n">loc</span></a><span class="p">[</span><span class="n">src</span><span class="p">,</span> <span class="p">:,</span> <span class="n">freq</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">real</span><span class="p">),</span>
                 <span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">ii</span><span class="si">}</span><span class="s2">.-&quot;</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;|Real|; freq=</span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s2"> Hz&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
                 <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rec_coords</span></a><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">::</span><span class="mi">3</span><span class="p">],</span>
                 <span class="nb">abs</span><span class="p">(</span><a href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.loc.html#xarray.DataArray.loc" title="xarray.DataArray.loc" class="sphx-glr-backref-module-xarray sphx-glr-backref-type-py-method"><span class="n">obs</span><span class="o">.</span><span class="n">loc</span></a><span class="p">[</span><span class="n">src</span><span class="p">,</span> <span class="p">:,</span> <span class="n">freq</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">imag</span><span class="p">),</span>
                 <span class="sa">f</span><span class="s2">&quot;C</span><span class="si">{</span><span class="n">ii</span><span class="si">}</span><span class="s2">.--&quot;</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;|Imag|; freq=</span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s2"> Hz&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
                 <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x-coordinate (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$|E_x|$ (V/m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Inline receivers for all sources" class="sphx-glr-single-img" src="../../_images/sphx_glr_simulation_002.png" />
</div>
<div class="section" id="how-to-store-surveys-and-simulations-to-disk">
<h2>How to store surveys and simulations to disk<a class="headerlink" href="#how-to-store-surveys-and-simulations-to-disk" title="Permalink to this headline">¶</a></h2>
<p>Survey and Simulations can store (and load) themselves to (from) disk.</p>
<ul class="simple">
<li><p>A survey stores all sources, receivers, frequencies, and the observed data.</p></li>
<li><p>A simulation stores the survey, the model, the synthetic data. (It can also
store much more, such as all electric fields, source and frequency
dependent meshes and models, etc. What it actually stores is defined by the
parameter <code class="docutils literal notranslate"><span class="pre">what</span></code>).</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Survey file name</span>
<span class="c1"># survey_fname = &#39;GemPy-II-survey-A.h5&#39;</span>

<span class="c1"># To store, run</span>
<span class="c1"># survey.to_file(survey_fname)  # .h5, .json, or .npz</span>

<span class="c1"># To load, run</span>
<span class="c1"># survey = emg3d.surveys.Survey.from_file(survey_fname)</span>

<span class="c1"># In the same manner you could store and load the entire simulation:</span>

<span class="c1"># Simulation file name</span>
<span class="c1"># simulation_fname = file-name.ending  # for ending in [h5, json, npz]</span>

<span class="c1"># To store, run</span>
<span class="c1"># simulation.to_file(simulation_fname, what=&#39;results&#39;)</span>

<span class="c1"># To load, run</span>
<span class="c1"># simulation = emg3d.simulations.Simulation.from_file(simulation_fname)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://emg3d.emsig.xyz/en/stable/api/emg3d.utils.Report.html#emg3d.utils.Report" title="emg3d.utils.Report" class="sphx-glr-backref-module-emg3d-utils sphx-glr-backref-type-py-class"><span class="n">emg3d</span><span class="o">.</span><span class="n">Report</span></a><span class="p">()</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<table style='border: 3px solid #ddd;'>
  <tr>
     <td style='text-align: center; font-weight: bold; font-size: 1.2em; border: 2px solid #fff;' colspan='6'>Sat Jul 17 17:52:16 2021 CEST</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>OS</td>
    <td style='text-align: left; border: 2px solid #fff;'>Linux</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>CPU(s)</td>
    <td style='text-align: left; border: 2px solid #fff;'>4</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Machine</td>
    <td style='text-align: left; border: 2px solid #fff;'>x86_64</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Architecture</td>
    <td style='text-align: left; border: 2px solid #fff;'>64bit</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>RAM</td>
    <td style='text-align: left; border: 2px solid #fff;'>15.5 GiB</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>Environment</td>
    <td style='text-align: left; border: 2px solid #fff;'>Python</td>
  </tr>
  <tr>
     <td style='text-align: center; border: 2px solid #fff;' colspan='6'>Python 3.9.4 | packaged by conda-forge | (default, May 10 2021, 22:13:33)
[GCC 9.3.0]</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>numpy</td>
    <td style='text-align: left; border: 2px solid #fff;'>1.21.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>scipy</td>
    <td style='text-align: left; border: 2px solid #fff;'>1.7.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>numba</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.53.1</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>emg3d</td>
    <td style='text-align: left; border: 2px solid #fff;'>1.1.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>empymod</td>
    <td style='text-align: left; border: 2px solid #fff;'>2.1.2</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>xarray</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.18.2</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>discretize</td>
    <td style='text-align: left; border: 2px solid #fff;'>0.7.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>h5py</td>
    <td style='text-align: left; border: 2px solid #fff;'>3.3.0</td>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>matplotlib</td>
    <td style='text-align: left; border: 2px solid #fff;'>3.4.2</td>
  </tr>
  <tr>
    <td style='text-align: right; background-color: #ccc; border: 2px solid #fff;'>tqdm</td>
    <td style='text-align: left; border: 2px solid #fff;'>4.61.2</td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
    <td style= border: 2px solid #fff;'></td>
  </tr>
  <tr>
     <td style='text-align: center; background-color: #ddd;border: 2px solid #fff;' colspan='6'>Intel(R) oneAPI Math Kernel Library Version 2021.2-Product Build 20210312 for Intel(R) 64 architecture applications</td>
  </tr>
</table>
</div>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  50.458 seconds)</p>
<p><strong>Estimated memory usage:</strong>  187 MB</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-tutorials-simulation-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/5c69886c2c0d300d99bc051984cabedb/simulation.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">simulation.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a01f12a02f6437dacee4c9dbd087a404/simulation.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">simulation.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="mapping.html" title="previous page">2. Model property mapping</a>
    <a class='right-next' id="next-link" href="gradient.html" title="next page">4. Gradient of the misfit function</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2018-2021, The emsig community.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>